var Jt=Object.defineProperty;var Xt=(W,I,z)=>I in W?Jt(W,I,{enumerable:!0,configurable:!0,writable:!0,value:z}):W[I]=z;var lt=(W,I,z)=>Xt(W,typeof I!="symbol"?I+"":I,z);import{ay as ge,b8 as $e,b7 as ue,aB as g,bd as xt,aC as $,be as st,aD as i,aE as c,aF as o,aG as e,aH as t,bm as w,bf as le,bg as de,bh as Ce,bn as n,aK as r,aJ as s,aI as S,bb as x,bc as j,bo as re,aA as ut,dV as el,bi as Le,by as Be,ce as it,b9 as ct,bs as Fe,bt as Ge,c6 as ke,cH as at,az as tl,dW as ll,cD as al,br as ol,cZ as nl,cf as _e,cF as sl,c3 as ot,c7 as ul}from"./chat-CUfIjAsy.js";import{S as il}from"./SyncWebDialog-Dv3UrGcF.js";import{_ as cl}from"./index.vue_vue_type_script_setup_true_lang-CvygeC7o.js";import"./AIModeParamSettingDialog.vue_vue_type_script_setup_true_lang-cRJioUrS.js";var Ne=(W=>(W.optimization="views.document.hitHandlingMethod.optimization",W.directly_return="views.document.hitHandlingMethod.directly_return",W))(Ne||{});const rl={class:"flex align-center"},dl={class:"mr-4"},ml={class:"lighter w-full",style:{"margin-top":"-20px"}},pl={class:"dialog-footer"},vl=ge({__name:"ImportDocumentDialog",props:{title:String},emits:["refresh"],setup(W,{expose:I,emit:z}){const u=$e(),{params:{id:C}}=u,Z=ue(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),E=z,p=g(),a=g(!1),h=g(!1),v=g({source_url:"",selector:"",hit_handling_method:"optimization",directly_return_similarity:.9,allow_download:!0}),R=g(""),U=g(""),k=g([]),A=xt({source_url:[{required:!0,message:$("views.document.form.source_url.requiredMessage"),trigger:"blur"}],directly_return_similarity:[{required:!0,message:$("views.document.form.similarity.requiredMessage"),trigger:"blur"}]}),N=g(!1);st(N,m=>{m||(v.value={source_url:"",selector:"",hit_handling_method:"optimization",directly_return_similarity:.9,allow_download:!0},h.value=!1,U.value="",R.value="",k.value=[])});const F=(m,f)=>{m?(U.value=m.type,R.value=m.id,v.value={hit_handling_method:m.hit_handling_method,directly_return_similarity:m.directly_return_similarity,...m.meta,meta:m.meta},h.value=!1):f?k.value=f:(U.value=1,h.value=!0),N.value=!0},G=async m=>{m&&await m.validate(f=>{if(f){if(h.value){const Q={source_url_list:v.value.source_url.split(`
`),selector:v.value.selector,allow_download:v.value.allow_download};j({type:"document",systemType:Z.value}).postWebDocument(C,Q,a).then(()=>{re($("views.document.tip.importMessage")),E("refresh"),N.value=!1})}else if(R.value){const Q={hit_handling_method:v.value.hit_handling_method,directly_return_similarity:v.value.directly_return_similarity,meta:{...v.value.meta,source_url:v.value.source_url,selector:v.value.selector,allow_download:v.value.allow_download}};j({type:"document",systemType:Z.value}).putDocument(C,R.value,Q,a).then(()=>{re($("common.settingSuccess")),E("refresh"),N.value=!1})}else if(k.value.length>0){const Q={hit_handling_method:v.value.hit_handling_method,directly_return_similarity:v.value.directly_return_similarity,id_list:k.value,allow_download:v.value.allow_download};j({type:"document",systemType:Z.value}).putBatchEditHitHandling(C,Q,a).then(()=>{re($("common.settingSuccess")),E("refresh"),N.value=!1})}}})};return I({open:F}),(m,f)=>{const Q=i("el-input"),Y=i("el-form-item"),K=i("AppIcon"),V=i("el-tooltip"),y=i("el-radio"),L=i("el-radio-group"),B=i("el-input-number"),H=i("el-checkbox"),q=i("el-form"),ee=i("el-button"),_=i("el-dialog");return o(),c(_,{title:W.title,modelValue:N.value,"onUpdate:modelValue":f[8]||(f[8]=D=>N.value=D),"close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,width:"550"},{footer:e(()=>[S("span",pl,[t(ee,{onClick:f[6]||(f[6]=x(D=>N.value=!1,["prevent"]))},{default:e(()=>[r(s(m.$t("common.cancel")),1)]),_:1}),t(ee,{type:"primary",onClick:f[7]||(f[7]=D=>G(p.value)),loading:a.value},{default:e(()=>[r(s(m.$t("common.confirm")),1)]),_:1},8,["loading"])])]),default:e(()=>[t(q,{"label-position":"top",ref_key:"webFormRef",ref:p,rules:A,model:v.value,"require-asterisk-position":"right"},{default:e(()=>[h.value?(o(),c(Y,{key:0,label:m.$t("views.document.form.source_url.label"),prop:"source_url"},{default:e(()=>[t(Q,{modelValue:v.value.source_url,"onUpdate:modelValue":f[0]||(f[0]=D=>v.value.source_url=D),placeholder:m.$t("views.document.form.source_url.placeholder"),rows:10,type:"textarea"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):!h.value&&U.value===1?(o(),c(Y,{key:1,label:m.$t("views.document.form.source_url.label"),prop:"source_url"},{default:e(()=>[t(Q,{modelValue:v.value.source_url,"onUpdate:modelValue":f[1]||(f[1]=D=>v.value.source_url=D),placeholder:m.$t("views.document.form.source_url.requiredMessage")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),U.value===1?(o(),c(Y,{key:2,label:m.$t("views.document.form.selector.label")},{default:e(()=>[t(Q,{modelValue:v.value.selector,"onUpdate:modelValue":f[2]||(f[2]=D=>v.value.selector=D),placeholder:m.$t("views.document.form.selector.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):w("",!0),h.value?w("",!0):(o(),c(Y,{key:3},{label:e(()=>[S("div",rl,[S("span",dl,s(m.$t("views.document.form.hit_handling_method.label")),1),t(V,{effect:"dark",content:m.$t("views.document.form.hit_handling_method.tooltip"),placement:"right"},{default:e(()=>[t(K,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:e(()=>[t(L,{modelValue:v.value.hit_handling_method,"onUpdate:modelValue":f[3]||(f[3]=D=>v.value.hit_handling_method=D),class:"radio-block mt-4"},{default:e(()=>[(o(!0),le(de,null,Ce(n(Ne),(D,ae)=>(o(),c(y,{key:ae,value:ae},{default:e(()=>[r(s(m.$t(D)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})),!h.value&&v.value.hit_handling_method==="directly_return"?(o(),c(Y,{key:4,prop:"directly_return_similarity"},{default:e(()=>[S("div",ml,[S("span",null,s(m.$t("views.document.form.similarity.label")),1),t(B,{modelValue:v.value.directly_return_similarity,"onUpdate:modelValue":f[4]||(f[4]=D=>v.value.directly_return_similarity=D),min:0,max:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",size:"small",class:"ml-4 mr-4"},null,8,["modelValue"]),S("span",null,s(m.$t("views.document.form.similarity.placeholder")),1)])]),_:1})):w("",!0),t(Y,{prop:"allow_download"},{default:e(()=>[t(H,{modelValue:v.value.allow_download,"onUpdate:modelValue":f[5]||(f[5]=D=>v.value.allow_download=D)},{default:e(()=>[r(s(m.$t("views.document.form.allow_download.label")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])}}}),fl={class:"flex align-center"},_l={class:"dialog-footer"},gl=ge({__name:"SelectKnowledgeDialog",props:{workspaceId:{type:String}},emits:["refresh"],setup(W,{expose:I,emit:z}){const u=$e(),{params:{id:C}}=u,{user:Z}=ut(),E=W,p=ue(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),a=z,h=g(!1),v=g(!1),R=g([]),U=g([]),k=g({selectKnowledge:""}),A={children:"children",label:"name",isLeaf:m=>m.resource_type?m.resource_type!=="folder":m.workspace_id==="None",disabled:(m,f)=>m.id===C||m.resource_type==="folder"&&(f==null?void 0:f.isLeaf)},N=async(m,f)=>{if(m.isLeaf)return f([]);const Q=m.level===0?Z.getWorkspaceId():m.data.id,Y=p.value==="systemManage"?{workspace_id:E.workspaceId,folder_id:m.level===0?E.workspaceId:m.data.id}:{folder_id:Q};await j({type:"knowledge",systemType:p.value}).getKnowledgeList(Y,h).then(K=>{f(K.data)})};st(v,m=>{m||(k.value.selectKnowledge="",R.value=[],U.value=[])});const F=m=>{U.value=m,v.value=!0},G=()=>{j({type:"document",systemType:p.value}).putMigrateMulDocument(C,k.value.selectKnowledge,U.value,h).then(()=>{a("refresh"),v.value=!1})};return I({open:F}),(m,f)=>{const Q=i("KnowledgeIcon"),Y=i("el-avatar"),K=i("el-tree-select"),V=i("el-form-item"),y=i("el-form"),L=i("el-button"),B=i("el-dialog");return o(),c(B,{title:`${m.$t("views.document.migrateDocument")}`,modelValue:v.value,"onUpdate:modelValue":f[2]||(f[2]=H=>v.value=H),width:"600",class:"select-knowledge-dialog","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[S("span",_l,[t(L,{onClick:f[1]||(f[1]=x(H=>v.value=!1,["prevent"]))},{default:e(()=>[r(s(m.$t("common.cancel")),1)]),_:1}),t(L,{type:"primary",onClick:G,disabled:!k.value.selectKnowledge||h.value},{default:e(()=>[r(s(m.$t("common.confirm")),1)]),_:1},8,["disabled"])])]),default:e(()=>[t(y,{ref:"FormRef",model:k.value,"label-position":"top","require-asterisk-position":"right"},{default:e(()=>[t(V,{label:m.$t("views.chatLog.selectKnowledge"),required:""},{default:e(()=>[t(K,{modelValue:k.value.selectKnowledge,"onUpdate:modelValue":f[0]||(f[0]=H=>k.value.selectKnowledge=H),props:A,"node-key":"id",lazy:"",load:N,placeholder:m.$t("views.chatLog.selectKnowledgePlaceholder")},{default:e(({data:H})=>[S("div",fl,[H.resource_type!=="folder"?(o(),c(Q,{key:0,class:"mr-12",size:20,type:H.type},null,8,["type"])):(o(),c(Y,{key:1,class:"mr-12",shape:"square",size:20,style:{background:"none"}},{default:e(()=>[...f[3]||(f[3]=[S("img",{src:el,style:{width:"100%"},alt:""},null,-1)])]),_:1})),r(" "+s(H.name),1)])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}}),J={EMBEDDING:1,GENERATE_PROBLEM:2,SYNC:3},M={PENDING:"0",STARTED:"1",SUCCESS:"2",FAILURE:"3",REVOKE:"4",REVOKED:"5",IGNORED:"n"};class nt{constructor(I){lt(this,"task_status");I||(I=""),I=I.split("").reverse().join(""),this.task_status={};for(const z in J){const u=J[z],C=u-1;this.task_status[u]=I[C]?I[C]:"n"}}toString(){const I=[];for(const z in J){const u=J[z];I.push(this.task_status[u])}return I.reverse().join("")}}const yl=ge({__name:"StatusTable",props:{status:{},statusMeta:{},stateMap:{},taskTypeMap:{}},setup(W){const I=W,z=E=>{const p=new nt(E.status);return Object.keys(J).map(a=>{const h=J[a];return{[h]:{[p.task_status[h]]:E.count}}}).reduce((a,h)=>({...a,...h}),{})},u=(E,p)=>E==null&&p?p:p==null&&E?E:typeof E=="object"&&typeof p=="object"?Le.mergeWith(E,p,u):E+p,C=ue(()=>(I.statusMeta.aggs?I.statusMeta.aggs:[]).map(E=>z(E)).reduce((E,p)=>Le.mergeWith(E,p,u),{})),Z=ue(()=>Object.keys(J).map(E=>{const p=J[E],a=new nt(I.status);return{type:p,state:a.task_status[p],aggs:C.value[p],time:I.statusMeta.state_time[p]}}).filter(E=>E.state!==M.IGNORED));return(E,p)=>{const a=i("SuccessFilled"),h=i("el-icon"),v=i("el-text"),R=i("CircleCloseFilled"),U=i("Loading");return o(!0),le(de,null,Ce(Z.value,k=>(o(),le("div",{key:k.type},[S("span",null,s(W.taskTypeMap[k.type])+"ï¼š",1),S("span",null,[k.state===n(M).SUCCESS||k.state===n(M).REVOKED?(o(),c(v,{key:0,class:"color-text-primary"},{default:e(()=>[t(h,{class:"color-success"},{default:e(()=>[t(a)]),_:1}),r(" "+s(W.stateMap[k.state](k.type)),1)]),_:2},1024)):k.state===n(M).FAILURE?(o(),c(v,{key:1,class:"color-text-primary"},{default:e(()=>[t(h,{class:"color-danger"},{default:e(()=>[t(R)]),_:1}),r(" "+s(W.stateMap[k.state](k.type)),1)]),_:2},1024)):k.state===n(M).STARTED?(o(),c(v,{key:2,class:"color-text-primary"},{default:e(()=>[t(h,{class:"is-loading color-primary"},{default:e(()=>[t(U)]),_:1}),r(" "+s(W.stateMap[k.state](k.type)),1)]),_:2},1024)):k.state===n(M).PENDING?(o(),c(v,{key:3,class:"color-text-primary"},{default:e(()=>[t(h,{class:"is-loading color-primary"},{default:e(()=>[t(U)]),_:1}),r(" "+s(W.stateMap[k.state](k.type)),1)]),_:2},1024)):k.state===n(M).REVOKE?(o(),c(v,{key:4,class:"color-text-primary"},{default:e(()=>[t(h,{class:"is-loading color-primary"},{default:e(()=>[t(U)]),_:1}),r(" "+s(W.stateMap[k.state](k.type)),1)]),_:2},1024)):w("",!0)]),S("span",{class:"ml-8 lighter",style:Be({color:[n(M).FAILURE,n(M).REVOKED].includes(k.state)?"#F54A45":""})},s(E.$t("views.document.fileStatus.finish"))+" "+s(Object.keys(k.aggs?k.aggs:{}).filter(A=>A==n(M).SUCCESS).map(A=>k.aggs[A]).reduce((A,N)=>A+N,0))+"/"+s(Object.values(k.aggs?k.aggs:{}).reduce((A,N)=>A+N,0)),5),t(v,{type:"info",class:"ml-12"},{default:e(()=>{var A;return[r(s(k.time?(A=k.time[k.state==n(M).REVOKED?n(M).REVOKED:n(M).PENDING])==null?void 0:A.substring(0,19):void 0),1)]}),_:2},1024)]))),128)}}}),hl=ge({__name:"Status",props:{status:{},statusMeta:{}},setup(W){const I=W,z=g(!1),u=[M.REVOKE,M.STARTED,M.PENDING,M.FAILURE,M.REVOKED,M.SUCCESS],C=ue(()=>{let a={key:0,value:""};for(const h in u){const v=u[h],R=I.status.indexOf(v);if(R>-1){a={key:I.status.length-R,value:v};break}}return a}),Z={[J.EMBEDDING]:$("views.document.fileStatus.EMBEDDING"),[J.GENERATE_PROBLEM]:$("views.document.fileStatus.GENERATE"),[J.SYNC]:$("views.document.fileStatus.SYNC")},E={[J.EMBEDDING]:$("views.knowledge.setting.vectorization"),[J.GENERATE_PROBLEM]:$("views.document.generateQuestion.title"),[J.SYNC]:$("views.knowledge.setting.sync")},p={[M.PENDING]:a=>$("views.document.fileStatus.PENDING"),[M.STARTED]:a=>Z[a],[M.REVOKE]:a=>$("views.document.fileStatus.REVOKE"),[M.REVOKED]:a=>$("views.document.fileStatus.SUCCESS"),[M.FAILURE]:a=>$("views.document.fileStatus.FAILURE"),[M.SUCCESS]:a=>$("views.document.fileStatus.SUCCESS")};return(a,h)=>{const v=i("SuccessFilled"),R=i("el-icon"),U=i("el-text"),k=i("CircleCloseFilled"),A=i("Loading"),N=i("el-popover");return o(),c(N,{visible:z.value,"onUpdate:visible":h[0]||(h[0]=F=>z.value=F),placement:"top",trigger:"hover","popper-style":{width:"auto"}},{default:e(()=>[z.value?(o(),c(yl,{key:0,status:W.status,statusMeta:W.statusMeta,taskTypeMap:E,stateMap:p},null,8,["status","statusMeta"])):w("",!0)]),reference:e(()=>{var F,G,m,f,Q,Y;return[((F=C.value)==null?void 0:F.value)===n(M).SUCCESS||((G=C.value)==null?void 0:G.value)===n(M).REVOKED?(o(),c(U,{key:0,class:"color-text-primary"},{default:e(()=>[t(R,{class:"color-success"},{default:e(()=>[t(v)]),_:1}),r(" "+s(p[C.value.value](C.value.key)),1)]),_:1})):((m=C.value)==null?void 0:m.value)===n(M).FAILURE?(o(),c(U,{key:1,class:"color-text-primary"},{default:e(()=>[t(R,{class:"color-danger"},{default:e(()=>[t(k)]),_:1}),r(" "+s(p[C.value.value](C.value.key)),1)]),_:1})):((f=C.value)==null?void 0:f.value)===n(M).STARTED?(o(),c(U,{key:2,class:"color-text-primary"},{default:e(()=>[t(R,{class:"is-loading color-primary"},{default:e(()=>[t(A)]),_:1}),r(" "+s(p[C.value.value](C.value.key)),1)]),_:1})):((Q=C.value)==null?void 0:Q.value)===n(M).PENDING?(o(),c(U,{key:3,class:"color-text-primary"},{default:e(()=>[t(R,{class:"is-loading color-primary"},{default:e(()=>[t(A)]),_:1}),r(" "+s(p[C.value.value](C.value.key)),1)]),_:1})):((Y=C.value)==null?void 0:Y.value)===n(M).REVOKE?(o(),c(U,{key:4,class:"color-text-primary"},{default:e(()=>[t(R,{class:"is-loading color-primary"},{default:e(()=>[t(A)]),_:1}),r(" "+s(p[C.value.value](C.value.key)),1)]),_:1})):w("",!0)]}),_:1},8,["visible"])}}}),kl={class:"dialog-footer"},bl=ge({__name:"EmbeddingContentDialog",setup(W,{expose:I}){const z=g(!1),u=g("error"),C={all:["0","1","2","3","4","5","n"],error:["0","1","3","4","5","n"]},Z=g(),E=()=>{Z.value&&Z.value(C[u.value]),a()},p=h=>{Z.value=h,z.value=!0},a=()=>{Z.value=void 0,z.value=!1};return I({open:p,close:a}),(h,v)=>{const R=i("el-radio"),U=i("el-radio-group"),k=i("el-button"),A=i("el-dialog");return o(),c(A,{modelValue:z.value,"onUpdate:modelValue":v[1]||(v[1]=N=>z.value=N),title:h.$t("components.selectParagraph.title"),"before-close":a,width:"450"},{footer:e(()=>[S("div",kl,[t(k,{onClick:a},{default:e(()=>[r(s(h.$t("common.cancel")),1)]),_:1}),t(k,{type:"primary",onClick:E},{default:e(()=>[r(s(h.$t("common.submit")),1)]),_:1})])]),default:e(()=>[t(U,{modelValue:u.value,"onUpdate:modelValue":v[0]||(v[0]=N=>u.value=N),class:"radio-block"},{default:e(()=>[t(R,{value:"error",size:"large"},{default:e(()=>[r(s(h.$t("components.selectParagraph.error")),1)]),_:1}),t(R,{value:"all",size:"large"},{default:e(()=>[r(s(h.$t("components.selectParagraph.all")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])}}}),wl={class:"dialog-footer"},$l=ge({__name:"CreateTagDialog",emits:["refresh"],setup(W,{expose:I,emit:z}){const u=$e(),{params:{id:C}}=u,Z=z,E=ue(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),p=g(),a=g(!1),h=g(!1),v=g(null),R=g([]),U=()=>{v.value?R.value.push({key:v.value}):R.value.push({})},k=G=>{R.value.splice(G,1)},A=()=>{p.value.validate(G=>{G&&j({type:"knowledge",systemType:E.value}).postTags(C,R.value,a).then(m=>{F(),Z("refresh",v.value)})})},N=G=>{const m=Le.cloneDeep(G);h.value=!0,v.value=m?m.key:null,R.value=m?[{key:m.key}]:[{}]},F=()=>{h.value=!1};return I({open:N,close:F}),(G,m)=>{const f=i("el-input"),Q=i("el-form-item"),Y=i("el-col"),K=i("AppIcon"),V=i("el-button"),y=i("el-row"),L=i("el-scrollbar"),B=i("el-form"),H=i("el-dialog");return o(),c(H,{modelValue:h.value,"onUpdate:modelValue":m[1]||(m[1]=q=>h.value=q),title:v.value?G.$t("views.document.tag.addValue"):G.$t("views.document.tag.create"),"before-close":F,"append-to-body":""},{footer:e(()=>[S("div",wl,[t(V,{onClick:F},{default:e(()=>[r(s(G.$t("common.cancel")),1)]),_:1}),t(V,{type:"primary",onClick:A},{default:e(()=>[r(s(G.$t("common.confirm")),1)]),_:1})])]),default:e(()=>[t(B,{ref_key:"FormRef",ref:p,model:{tags:R.value},"label-position":"top","require-asterisk-position":"right",onSubmit:m[0]||(m[0]=x(()=>{},["prevent"]))},{default:e(()=>[t(L,null,{default:e(()=>[t(y,{gutter:8,style:{"margin-right":"10px"},class:"tag-list-max-list"},{default:e(()=>[(o(!0),le(de,null,Ce(R.value,(q,ee)=>(o(),le(de,{key:q},[t(Y,{span:12},{default:e(()=>[t(Q,{label:ee===0?G.$t("views.document.tag.key"):"",prop:`tags.${ee}.key`,rules:{required:!0,message:G.$t("views.document.tag.requiredMessage1"),trigger:"blur"}},{default:e(()=>[t(f,{modelValue:q.key,"onUpdate:modelValue":_=>q.key=_,disabled:!!v.value,class:"w-full",placeholder:G.$t("views.document.tag.requiredMessage1")},null,8,["modelValue","onUpdate:modelValue","disabled","placeholder"])]),_:2},1032,["label","prop","rules"])]),_:2},1024),t(Y,{span:11},{default:e(()=>[t(Q,{label:ee===0?G.$t("views.document.tag.value"):"",prop:`tags.${ee}.value`,rules:{required:!0,message:G.$t("views.document.tag.requiredMessage2"),trigger:"blur"},class:"w-full"},{default:e(()=>[t(f,{modelValue:q.value,"onUpdate:modelValue":_=>q.value=_,placeholder:G.$t("views.document.tag.requiredMessage2")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop","rules"])]),_:2},1024),t(Y,{span:1},{default:e(()=>[t(V,{disabled:R.value.length===1,link:"",type:"info",onClick:_=>k(ee),style:Be({marginTop:ee===0?"35px":"5px"})},{default:e(()=>[t(K,{iconName:"app-delete"})]),_:1},8,["disabled","onClick","style"])]),_:2},1024)],64))),128))]),_:1})]),_:1})]),_:1},8,["model"]),t(V,{link:"",type:"primary",onClick:U},{default:e(()=>[t(K,{iconName:"app-add-outlined",class:"mr-4"}),r(" "+s(G.$t("common.add")),1)]),_:1})]),_:1},8,["modelValue","title"])}}}),rt=it($l,[["__scopeId","data-v-76dc2830"]]),Cl={class:"dialog-footer"},Tl=ge({__name:"EditTagDialog",emits:["refresh"],setup(W,{expose:I,emit:z}){const u=$e(),{params:{id:C}}=u,Z=z,E=ue(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),p=g(),a=g(!1),h=g({id:"",key:"",value:""}),v=g(!1),R=g(!1),U=()=>{p.value.validate(N=>{N&&j({type:"knowledge",systemType:E.value}).putTag(C,h.value.id,h.value,v).then(F=>{A(),Z("refresh")})})},k=(N,F)=>{R.value=!0,h.value.id=N.id,h.value.key=N.key,h.value.value=N.value,a.value=F},A=()=>{R.value=!1};return I({open:k,close:A}),(N,F)=>{const G=i("el-input"),m=i("el-form-item"),f=i("el-col"),Q=i("el-row"),Y=i("el-form"),K=i("el-button"),V=i("el-dialog");return o(),c(V,{modelValue:R.value,"onUpdate:modelValue":F[4]||(F[4]=y=>R.value=y),title:a.value?N.$t("views.document.tag.edit"):N.$t("views.document.tag.editValue"),"before-close":A,width:a.value?"500px":"50%"},{footer:e(()=>[S("div",Cl,[t(K,{onClick:A},{default:e(()=>[r(s(N.$t("common.cancel")),1)]),_:1}),t(K,{type:"primary",onClick:U},{default:e(()=>[r(s(N.$t("common.confirm")),1)]),_:1})])]),default:e(()=>[t(Y,{ref_key:"FormRef",ref:p,model:h.value,"label-position":"top","require-asterisk-position":"right",onSubmit:F[3]||(F[3]=x(()=>{},["prevent"]))},{default:e(()=>[a.value?(o(),c(m,{key:0,label:N.$t("views.document.tag.key"),rules:{required:!0,message:N.$t("views.document.tag.requiredMessage1"),trigger:"blur"},prop:"key"},{default:e(()=>[t(G,{modelValue:h.value.key,"onUpdate:modelValue":F[0]||(F[0]=y=>h.value.key=y)},null,8,["modelValue"])]),_:1},8,["label","rules"])):(o(),c(Q,{key:1,gutter:8,align:"bottom"},{default:e(()=>[t(f,{span:12},{default:e(()=>[t(m,{label:N.$t("views.document.tag.key"),prop:"key",rules:{required:!0,message:N.$t("views.document.tag.requiredMessage1"),trigger:"blur"}},{default:e(()=>[t(G,{modelValue:h.value.key,"onUpdate:modelValue":F[1]||(F[1]=y=>h.value.key=y),disabled:!0},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),t(f,{span:12},{default:e(()=>[t(m,{label:N.$t("views.document.tag.value"),prop:"value",rules:{required:!0,message:N.$t("views.document.tag.requiredMessage2"),trigger:"blur"}},{default:e(()=>[t(G,{modelValue:h.value.value,"onUpdate:modelValue":F[2]||(F[2]=y=>h.value.value=y)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1})]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title","width"])}}}),Dl={class:"flex-between mb-16"},El={class:"flex-between"},Sl={key:0},Vl={class:"mr-4"},Rl={class:"mr-4"},Ml={class:"flex-between"},Nl={class:"mr-4"},Il=ge({__name:"TagDrawer",emits:["refresh"],setup(W,{expose:I,emit:z}){const u=$e(),{params:{id:C,folderId:Z}}=u,E=ue(()=>Z==="share"),p=ue(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace"),a=ue(()=>ct.knowledge[p.value]),h=g(!1),v=g(!1),R=g(""),U=g([]),k=g(null);function A(_){k.value=_.id}function N(){k.value=null}const F=ue(()=>{const _=[];return U.value.forEach(D=>{D.values&&D.values.length>0&&D.values.forEach((ae,te)=>{_.push({id:ae.id,key:D.key,value:ae.value,keyIndex:te})})}),_}),G=({row:_,column:D,rowIndex:ae,columnIndex:te})=>{if(te===0||te===1)return _.keyIndex===0?{rowspan:F.value.filter(pe=>pe.key===_.key).length,colspan:1}:{rowspan:0,colspan:0}},m=g([]),f=_=>{m.value=_},Q=g();function Y(_){var D;(D=Q.value)==null||D.open(_)}function K(){ke($("views.document.tag.deleteConfirm"),$("views.document.tag.deleteTip"),{confirmButtonText:$("common.delete"),confirmButtonClass:"danger"}).then(()=>{const _=m.value.map(D=>D.id);j({type:"knowledge",systemType:p.value}).delMulTag(C,_).then(()=>{q()})}).catch(()=>{})}const V=g();function y(_){var D;(D=V.value)==null||D.open(_,!0)}function L(_){ke($("views.document.tag.deleteConfirm")+_.key,$("views.document.tag.deleteTip"),{confirmButtonText:$("common.delete"),confirmButtonClass:"danger"}).then(()=>{j({type:"knowledge",systemType:p.value}).delTag(C,_.id,"key").then(()=>{q()})}).catch(()=>{})}function B(_){var D;(D=V.value)==null||D.open(_,!1)}function H(_){ke($("views.document.tag.deleteConfirm")+_.value,$("views.document.tag.deleteTip"),{confirmButtonText:$("common.delete"),confirmButtonClass:"danger"}).then(()=>{j({type:"knowledge",systemType:p.value}).delTag(C,_.id,"one").then(()=>{q()})}).catch(()=>{})}function q(){const _={...R.value&&{name:R.value}};j({type:"knowledge",systemType:p.value,isShared:E.value}).getTags(C,_,h).then(D=>{U.value=D.data})}return I({open:()=>{R.value="",v.value=!0,q()}}),(_,D)=>{const ae=i("el-button"),te=i("el-input"),fe=i("el-table-column"),pe=i("AppIcon"),ie=i("el-tooltip"),ve=i("el-table"),oe=i("el-drawer"),me=Fe("loading");return o(),le(de,null,[t(oe,{modelValue:v.value,"onUpdate:modelValue":D[2]||(D[2]=ne=>v.value=ne),size:"60%","append-to-body":!0},{header:e(()=>[S("h4",null,s(_.$t("views.document.tag.label")),1)]),default:e(()=>[S("div",Dl,[S("div",null,[a.value.tag_create(n(C))?(o(),c(ae,{key:0,type:"primary",onClick:D[0]||(D[0]=ne=>Y())},{default:e(()=>[r(s(_.$t("views.document.tag.create")),1)]),_:1})):w("",!0),a.value.tag_delete(n(C))?(o(),c(ae,{key:1,disabled:m.value.length===0,onClick:K},{default:e(()=>[r(s(_.$t("common.delete")),1)]),_:1},8,["disabled"])):w("",!0)]),t(te,{modelValue:R.value,"onUpdate:modelValue":D[1]||(D[1]=ne=>R.value=ne),"prefix-icon":"Search",class:"w-240",onChange:q,clearable:"",placeholder:_.$t("common.search")},null,8,["modelValue","placeholder"])]),Ge((o(),c(ve,{data:F.value,"span-method":G,onSelectionChange:f,onCellMouseEnter:A,onCellMouseLeave:N},{default:e(()=>[t(fe,{type:"selection",width:"55"}),t(fe,{label:_.$t("views.document.tag.key")},{default:e(({row:ne})=>[S("div",El,[r(s(ne.key)+" ",1),k.value===ne.id?(o(),le("div",Sl,[S("span",Vl,[t(ie,{effect:"dark",content:_.$t("views.document.tag.addValue")},{default:e(()=>[a.value.tag_create(n(C))?(o(),c(ae,{key:0,type:"primary",text:"",onClick:x(Te=>Y(ne),["stop"])},{default:e(()=>[t(pe,{iconName:"app-add-outlined"})]),_:1},8,["onClick"])):w("",!0)]),_:2},1032,["content"])]),S("span",Rl,[t(ie,{effect:"dark",content:_.$t("views.document.tag.edit")},{default:e(()=>[a.value.tag_edit(n(C))?(o(),c(ae,{key:0,type:"primary",text:"",onClick:x(Te=>y(ne),["stop"])},{default:e(()=>[t(pe,{iconName:"app-edit"})]),_:1},8,["onClick"])):w("",!0)]),_:2},1032,["content"])]),t(ie,{effect:"dark",content:_.$t("common.delete")},{default:e(()=>[a.value.tag_delete(n(C))?(o(),c(ae,{key:0,type:"primary",text:"",onClick:x(Te=>L(ne),["stop"])},{default:e(()=>[t(pe,{iconName:"app-delete"})]),_:1},8,["onClick"])):w("",!0)]),_:2},1032,["content"])])):w("",!0)])]),_:1},8,["label"]),t(fe,{label:_.$t("views.document.tag.value"),"class-name":"border-l"},{default:e(({row:ne})=>[S("div",Ml,s(ne.value),1)]),_:1},8,["label"]),t(fe,{label:_.$t("common.operation"),align:"left",width:"100",fixed:"right"},{default:e(({row:ne})=>[S("span",Nl,[t(ie,{effect:"dark",content:_.$t("views.document.tag.editValue")},{default:e(()=>[a.value.tag_edit(n(C))?(o(),c(ae,{key:0,type:"primary",text:"",onClick:x(Te=>B(ne),["stop"])},{default:e(()=>[t(pe,{iconName:"app-edit"})]),_:1},8,["onClick"])):w("",!0)]),_:2},1032,["content"])]),t(ie,{effect:"dark",content:_.$t("common.delete")},{default:e(()=>[a.value.tag_delete(n(C))?(o(),c(ae,{key:0,type:"primary",text:"",onClick:x(Te=>H(ne),["stop"])},{default:e(()=>[t(pe,{iconName:"app-delete"})]),_:1},8,["onClick"])):w("",!0)]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])),[[me,h.value]])]),_:1},8,["modelValue"]),t(rt,{ref_key:"createTagDialogRef",ref:Q,onRefresh:q},null,512),t(Tl,{ref_key:"editTagDialogRef",ref:V,onRefresh:q},null,512)],64)}}}),Ul={class:"w-full text-left cursor"},Al={class:"w-full text-left cursor"},Ll={class:"dialog-footer"},dt=ge({__name:"MulAddTagDialog",props:{apiType:{}},emits:["addTags"],setup(W,{expose:I,emit:z}){const u=z,C=W,Z=$e(),{params:{id:E,folderId:p}}=Z,a=ue(()=>p==="share"),h=g(!1),v=g(),R=g(!1),U=g([]),k=g(),A=()=>{U.value.push({})},N=y=>{U.value.splice(y,1)};function F(y){y.value=null}function G(y){let L=null;return y&&y.key&&(L=k.value.find(B=>B.key===y.key)),L?L.values:[]}const m=()=>{v.value.validate(y=>{y&&u("addTags",U.value.map(L=>L.value))})};function f(y){j({type:"knowledge",systemType:C.apiType,isShared:a.value}).getTags(E,{},h).then(L=>{k.value=L.data})}const Q=g();function Y(y){var L;(L=Q.value)==null||L.open(y)}const K=()=>{f(),R.value=!0,U.value=[{}]},V=()=>{R.value=!1};return I({open:K,close:V}),(y,L)=>{const B=i("el-option"),H=i("AppIcon"),q=i("el-button"),ee=i("el-select"),_=i("el-form-item"),D=i("el-col"),ae=i("el-row"),te=i("el-scrollbar"),fe=i("el-form"),pe=i("el-dialog");return o(),c(pe,{modelValue:R.value,"onUpdate:modelValue":L[2]||(L[2]=ie=>R.value=ie),title:y.$t("views.document.tag.addTag"),"before-close":V},{footer:e(()=>[S("div",Ll,[t(q,{onClick:V},{default:e(()=>[r(s(y.$t("common.cancel")),1)]),_:1}),t(q,{type:"primary",onClick:m},{default:e(()=>[r(s(y.$t("common.confirm")),1)]),_:1})])]),default:e(()=>[t(fe,{ref_key:"FormRef",ref:v,model:{tagList:U.value},"label-position":"top","require-asterisk-position":"right",onSubmit:L[1]||(L[1]=x(()=>{},["prevent"]))},{default:e(()=>[t(te,null,{default:e(()=>[t(ae,{gutter:8,style:{"margin-right":"10px"},class:"tag-list-max-list"},{default:e(()=>[(o(!0),le(de,null,Ce(U.value,(ie,ve)=>(o(),le(de,{key:ie},[t(D,{span:12},{default:e(()=>[t(_,{label:ve===0?y.$t("views.document.tag.key"):"",prop:`tagList.${ve}.key`,rules:{required:!0,message:y.$t("views.document.tag.requiredMessage1"),trigger:"blur"}},{default:e(()=>[t(ee,{modelValue:ie.key,"onUpdate:modelValue":oe=>ie.key=oe,onChange:oe=>F(ie),filterable:"",placeholder:y.$t("views.document.tag.requiredMessage1"),loading:h.value},{footer:e(()=>[at(y.$slots,"footer",{},()=>[S("div",Ul,[t(q,{type:"primary",link:"",onClick:L[0]||(L[0]=oe=>Y())},{default:e(()=>[t(H,{iconName:"app-add-outlined",class:"mr-4"}),r(" "+s(y.$t("views.document.tag.create")),1)]),_:1})])])]),default:e(()=>[(o(!0),le(de,null,Ce(k.value,oe=>(o(),c(B,{key:oe,value:oe.key,label:oe.key},null,8,["value","label"]))),128))]),_:3},8,["modelValue","onUpdate:modelValue","onChange","placeholder","loading"])]),_:2},1032,["label","prop","rules"])]),_:2},1024),t(D,{span:11},{default:e(()=>[t(_,{label:ve===0?y.$t("views.document.tag.value"):"",prop:`tagList.${ve}.value`,rules:{required:!0,message:y.$t("views.document.tag.requiredMessage2"),trigger:"blur"}},{default:e(()=>[t(ee,{modelValue:ie.value,"onUpdate:modelValue":oe=>ie.value=oe,filterable:"",placeholder:y.$t("views.document.tag.requiredMessage2")},{footer:e(()=>[at(y.$slots,"footer",{},()=>[S("div",Al,[t(q,{type:"primary",link:"",onClick:oe=>Y(ie)},{default:e(()=>[t(H,{iconName:"app-add-outlined",class:"mr-4"}),r(" "+s(y.$t("views.document.tag.createValue")),1)]),_:1},8,["onClick"])])])]),default:e(()=>[(o(!0),le(de,null,Ce(G(ie),oe=>(o(),c(B,{key:oe,value:oe.id,label:oe.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop","rules"])]),_:2},1024),t(D,{span:1},{default:e(()=>[t(q,{disabled:U.value.length===1,text:"",onClick:oe=>N(ve),style:Be({marginTop:ve===0?"35px":"5px"})},{default:e(()=>[t(H,{iconName:"app-delete"})]),_:1},8,["disabled","onClick","style"])]),_:2},1024)],64))),128))]),_:3})]),_:3})]),_:3},8,["model"]),t(q,{link:"",type:"primary",onClick:A},{default:e(()=>[t(H,{iconName:"app-add-outlined",class:"mr-4"}),r(" "+s(y.$t("common.add")),1)]),_:1}),t(rt,{ref_key:"createTagDialogRef",ref:Q,onRefresh:f},null,512)]),_:3},8,["modelValue","title"])}}}),Bl={class:"flex-between mb-16"},Fl={class:"flex-between"},Gl=ge({__name:"TagSettingDrawer",emits:["refresh"],setup(W,{expose:I,emit:z}){const u=$e(),{params:{id:C,folderId:Z}}=u,E=ue(()=>u.path.includes("shared")?"systemShare":u.path.includes("resource-management")?"systemManage":"workspace");ue(()=>Z==="share");const p=g(""),a=g(!1),h=g(!1),v=g(""),R=g([]),U=ue(()=>{const V=[];return R.value.forEach(y=>{y.values&&y.values.length>0&&y.values.forEach((L,B)=>{V.push({id:L.id,key:y.key,value:L.value,keyIndex:B})})}),V}),k=({row:V,column:y,rowIndex:L,columnIndex:B})=>{if(B===0||B===1)return V.keyIndex===0?{rowspan:U.value.filter(q=>q.key===V.key).length,colspan:1}:{rowspan:0,colspan:0}},A=g([]),N=V=>{A.value=V};function F(){const V=A.value.reduce((y,L)=>{const H=U.value.filter(q=>q.key===L.key).map(q=>q.id);return[...y,...H]},[]);j({type:"document",systemType:E.value}).delMulDocumentTag(C,p.value,V,a).then(()=>{m()})}function G(V){j({type:"document",systemType:E.value}).delMulDocumentTag(C,p.value,[V.id],a).then(()=>{m()})}function m(){const V={...v.value&&{name:v.value}};j({type:"document",systemType:E.value}).getDocumentTags(C,p.value,V,a).then(y=>{R.value=y.data})}const f=g();function Q(){var V;(V=f.value)==null||V.open()}function Y(V){j({type:"document",systemType:E.value}).postDocumentTags(C,p.value,V,a).then(()=>{var y;(y=f.value)==null||y.close(),m()})}return I({open:V=>{v.value="",h.value=!0,p.value=V.id,m()}}),(V,y)=>{const L=i("el-button"),B=i("el-input"),H=i("el-table-column"),q=i("AppIcon"),ee=i("el-tooltip"),_=i("el-table"),D=i("el-drawer"),ae=Fe("loading");return o(),le(de,null,[t(D,{modelValue:h.value,"onUpdate:modelValue":y[2]||(y[2]=te=>h.value=te),size:"60%","append-to-body":!0},{header:e(()=>[S("h4",null,s(V.$t("views.document.tag.setting")),1)]),default:e(()=>[S("div",Bl,[S("div",null,[t(L,{type:"primary",onClick:y[0]||(y[0]=te=>Q())},{default:e(()=>[r(s(V.$t("views.document.tag.addTag")),1)]),_:1}),t(L,{disabled:A.value.length===0,onClick:F},{default:e(()=>[r(s(V.$t("common.delete")),1)]),_:1},8,["disabled"])]),t(B,{modelValue:v.value,"onUpdate:modelValue":y[1]||(y[1]=te=>v.value=te),"prefix-icon":"Search",class:"w-240",onChange:m,clearable:"",placeholder:V.$t("common.search")},null,8,["modelValue","placeholder"])]),Ge((o(),c(_,{data:U.value,"span-method":k,onSelectionChange:N},{default:e(()=>[t(H,{type:"selection",width:"55"}),t(H,{label:V.$t("views.document.tag.key")},{default:e(({row:te})=>[S("div",Fl,s(te.key),1)]),_:1},8,["label"]),t(H,{label:V.$t("views.document.tag.value"),"class-name":"border-l"},{default:e(({row:te})=>[r(s(te.value),1)]),_:1},8,["label"]),t(H,{label:V.$t("common.operation"),align:"left",width:"100",fixed:"right"},{default:e(({row:te})=>[t(ee,{effect:"dark",content:V.$t("common.delete")},{default:e(()=>[t(L,{type:"primary",text:"",onClick:x(fe=>G(te),["stop"])},{default:e(()=>[t(q,{iconName:"app-delete"})]),_:1},8,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])),[[ae,a.value]])]),_:1},8,["modelValue"]),t(dt,{ref_key:"addTagDialogRef",ref:f,onAddTags:Y,apiType:E.value},null,8,["apiType"])],64)}}}),Kl={class:"document p-16-24"},Pl={class:"mb-16"},ql={class:"main-calc-height"},Ol={class:"p-24"},zl={class:"flex-between"},jl={class:"flex"},Wl={class:"flex-between complex-search"},Hl={key:1},Ql={key:0,class:"flex align-center"},Zl={class:"color-text-primary"},Yl={key:1,class:"flex align-center"},Jl={class:"color-text-primary"},Xl={class:"mr-4"},xl={key:0,class:"mr-4"},ea={class:"mr-4"},ta={class:"mr-4"},la={class:"mr-4"},aa={class:"mr-4"},oa={key:0,class:"mul-operation w-full flex"},we="documents",na=ge({__name:"index",setup(W){const I=$e(),z=tl(),{params:{id:u,folderId:C}}=I,{common:Z}=ut();ll(()=>{Z.savePage(we,null),Z.saveCondition(we,null)}),al(l=>{l.name!=="Paragraph"?(Z.savePage(we,null),Z.saveCondition(we,null)):Z.saveCondition(we,{filterText:Y.value,filterMethod:K.value})});const E=ue(()=>C==="share"),p=ue(()=>I.path.includes("shared")?"systemShare":I.path.includes("resource-management")?"systemManage":I.path.includes("share/")?"workspaceShare":"workspace"),a=ue(()=>ct.knowledge[p.value]),h=l=>a.value.doc_migrate(l)||(B==null?void 0:B.value.type)===1&&a.value.doc_sync(l)||(B==null?void 0:B.value.type)===2&&a.value.doc_sync(l)||a.value.doc_delete(l)||a.value.doc_tag(l),v=l=>a.value.doc_generate(l)||a.value.doc_migrate(l)||a.value.doc_export(l)||a.value.doc_download(l)||a.value.doc_delete(l)||a.value.doc_tag(l)||a.value.doc_replace(l),R=l=>a.value.sync(l)||a.value.doc_generate(l)||a.value.doc_migrate(l)||a.value.doc_export(l)||a.value.doc_delete(l),U=(l,d)=>{const T=l.split("").reverse();return d-1>T.length+1?"n":T[d-1]},k=g("name"),A=g({name:"",tag:""}),N=ue(()=>Z.paginationConfig[we]),F=ue(()=>Z.search[we]),G=g(),m=g(),f=g(!1);let Q;const Y=g(""),K=g({}),V=g(""),y=g([]),L=g(null),B=g({}),H=g({current_page:1,page_size:10,total:0}),q=g(),ee=g(),_=g([]),D=g(""),ae=g(),te=l=>{j({type:"document",systemType:p.value}).exportDocument(l.name,l.knowledge_id,l.id,f).then(()=>{re($("common.exportSuccess"))})},fe=l=>{j({type:"document",systemType:p.value}).exportDocumentZip(l.name,l.knowledge_id,l.id,f).then(()=>{re($("common.exportSuccess"))})};function pe(l){const d=[];_.value.map(O=>{O&&d.push(O.id)});const T={id_list:d,type:l};j({type:"document",systemType:p.value}).putBatchCancelTask(u,T,f).then(()=>{var O;re($("views.document.tip.cancelSuccess")),(O=ee.value)==null||O.clearSelection()})}function ie(){var l;(l=ee.value)==null||l.clearSelection()}function ve(l){const d=[];l?d.push(l.id):_.value.map(T=>{T&&d.push(T.id)}),ae.value.open(d)}function oe(l){K.value[l.attr]=l.command,l.attr=="status"&&(K.value.task_type=l.task_type),se()}function me(l,d,T){return{attr:l,command:d,task_type:T}}const ne=(l,d)=>{j({type:"document",systemType:p.value}).putCancelTask(u,l.id,{type:d}).then(()=>{re($("views.document.tip.sendMessage"))})};function Te(){D.value=$("views.document.importDocument"),q.value.open()}function Ke(l){D.value=$("common.setting"),q.value.open(l)}const mt=l=>{_.value=l};function pt(){D.value=$("common.setting");const l=_.value.map(d=>d.id);q.value.open(null,l)}const vt=()=>{Q=setInterval(()=>{se(!0)},6e3)},ft=()=>{Q&&clearInterval(Q)};function _t(l){+l.type==1?yt(l):gt(l)}function gt(l){ke($("views.document.sync.confirmTitle"),$("views.document.sync.confirmMessage1"),{confirmButtonText:$("views.document.sync.label"),confirmButtonClass:"danger"}).then(()=>{j({type:"document",systemType:p.value}).putLarkDocumentSync(u,l.id).then(()=>{se()})}).catch(()=>{})}function yt(l){var d;(d=l.meta)!=null&&d.source_url?ke($("views.document.sync.confirmTitle"),$("views.document.sync.confirmMessage1"),{confirmButtonText:$("views.document.sync.label"),confirmButtonClass:"danger"}).then(()=>{j({type:"document",systemType:p.value}).putDocumentSync(l.knowledge_id,l.id).then(()=>{se()})}).catch(()=>{}):ke($("common.tip"),$("views.document.sync.confirmMessage2"),{confirmButtonText:$("common.confirm"),type:"warning"}).then(()=>{}).catch(()=>{})}function Pe(l){var T;const d=O=>j({type:"document",systemType:p.value}).putDocumentRefresh(l.knowledge_id,l.id,O).then(()=>{se()});(T=G.value)==null||T.open(d)}function ht(l,d){d&&d.type==="selection"||z.push({path:`/paragraph/${u}/${l.id}`,query:{from:p.value,isShared:E.value?"true":"false"}})}function kt(l){f.value=!0;const d=[{name:l}];j({type:"document",systemType:p.value}).putMulDocument(u,d).then(()=>{se(),re($("common.createSuccess"))}).catch(()=>{f.value=!1})}function bt(){const l=[];_.value.map(d=>{d&&l.push(d.id)}),ke($("views.document.sync.confirmTitle"),$("views.document.sync.confirmMessage1"),{confirmButtonText:$("views.document.sync.label"),confirmButtonClass:"danger"}).then(()=>{j({type:"document",systemType:p.value}).putMulSyncDocument(u,l,f).then(()=>{re($("views.document.sync.successMessage")),se()})}).catch(()=>{})}function wt(){const l=[];_.value.map(d=>{d&&l.push(d.id)}),j({type:"document",systemType:p.value}).putMulLarkSyncDocument(u,l,f).then(()=>{re($("views.document.sync.successMessage")),se()})}function $t(){ke(`${$("views.document.delete.confirmTitle1")} ${_.value.length} ${$("views.document.delete.confirmTitle2")}`,$("views.document.delete.confirmMessage"),{confirmButtonText:$("common.confirm"),confirmButtonClass:"danger"}).then(()=>{const l=[];_.value.map(d=>{d&&l.push(d.id)}),j({type:"document",systemType:p.value}).delMulDocument(u,l,f).then(()=>{var d;re($("views.document.delete.successMessage")),(d=ee.value)==null||d.clearSelection(),se()})}).catch(()=>{})}function Ct(){var T;const l=_.value.map(O=>O.id),d=O=>{j({type:"document",systemType:p.value}).putBatchRefresh(u,l,O,f).then(()=>{var P;re($("views.document.tip.vectorizationSuccess")),(P=ee.value)==null||P.clearSelection()})};(T=G.value)==null||T.open(d)}function Tt(l){j({type:"document",systemType:p.value}).getDownloadSourceFile(u,l.id,l.name).then(()=>{se()})}const qe=g();function Dt(l,d){const T=new FormData;T.append("file",l.raw,l.name),qe.value.clearFiles(),j({type:"document",systemType:p.value}).postReplaceSourceFile(u,d.id,T,f).then(()=>{se()}).catch(O=>{})}function Oe(l){ke(`${$("views.document.delete.confirmTitle3")} ${l.name} ?`,`${$("views.document.delete.confirmMessage1")} ${l.paragraph_count} ${$("views.document.delete.confirmMessage2")}`,{confirmButtonText:$("common.confirm"),confirmButtonClass:"danger"}).then(()=>{j({type:"document",systemType:p.value}).delDocument(u,l.id,f).then(()=>{re($("common.deleteSuccess")),se()})}).catch(()=>{})}function ze(l,d,T){j({type:"document",systemType:p.value}).putDocument(u,l,d,f).then(O=>{const P=y.value.findIndex(be=>be.id===l);return y.value.splice(P,1,O.data),re(T),!0}).catch(()=>!1)}async function Et(l){const d={is_active:!l.is_active},T=l.is_active?$("common.status.disableSuccess"):$("common.status.enableSuccess");await ze(l.id,d,T)}function St(l,d){l?ze(d,{name:l},$("common.modifySuccess")):ul($("views.document.tip.nameMessage"))}function Vt(l){L.value=l.id}function Rt(){L.value=null}function Mt(){H.value.current_page=1,se()}function Nt({prop:l,order:d}){V.value=d==="ascending"?l:`-${l}`,se()}function se(l){const d={...K.value,order_by:V.value,folder_id:C};A.value[k.value]&&(d[k.value]=A.value[k.value]),j({type:"document",isShared:E.value,systemType:p.value}).getDocumentPage(u,H.value,d,l?void 0:f).then(T=>{y.value=T.data.records,H.value.total=T.data.total})}const It=()=>{A.value={name:"",tag:""}};function Ut(){j({type:"knowledge",isShared:E.value,systemType:p.value}).getKnowledgeDetail(u,f).then(l=>{B.value=l.data})}function At(){var l;(l=ee.value)==null||l.clearSelection(),se()}function Se(){H.value.current_page=1,se()}const je=g();function Ie(l){const d=[];l?d.push(l.id):_.value.map(T=>{T&&d.push(T.id)}),je.value.open(d,"document")}const We=g();function Lt(){We.value.open()}const He=g();function Qe(l){He.value.open(l)}const Ue=g();function Bt(){var l;(l=Ue.value)==null||l.open()}function Ft(l){const d=_.value.map(T=>T.id);j({type:"document",systemType:p.value}).postMulDocumentTags(u,{tag_ids:l,document_ids:d},f).then(()=>{var T;(T=Ue.value)==null||T.close(),se(),ie()})}return ol(()=>{Ut(),N.value&&(H.value=N.value),F.value&&(Y.value=F.value.filterText,K.value=F.value.filterMethod),se(),vt()}),nl(()=>{ft()}),(l,d)=>{var Je;const T=i("el-button"),O=i("AppIcon"),P=i("el-dropdown-item"),be=i("el-dropdown-menu"),De=i("el-dropdown"),Ze=i("el-option"),Gt=i("el-select"),Ye=i("el-input"),ye=i("el-table-column"),Kt=i("ReadWrite"),Ae=i("Filter"),he=i("el-icon"),Pt=i("SuccessFilled"),qt=i("el-switch"),Ot=i("el-divider"),Ve=i("Close"),Ee=i("el-tooltip"),zt=i("Download"),jt=i("Upload"),Wt=i("el-upload"),Ht=i("app-table"),Qt=i("el-card"),Zt=i("el-text"),Yt=Fe("loading");return o(),le("div",Kl,[S("h2",Pl,s(l.$t("common.fileUpload.document")),1),t(Qt,{style:{"--el-card-padding":"0"}},{default:e(()=>{var Re,Xe,xe,et;return[S("div",ql,[S("div",Ol,[S("div",zl,[S("div",null,[E.value?w("",!0):(o(),le(de,{key:0},[((Re=B.value)==null?void 0:Re.type)===0&&a.value.doc_create(n(u))?(o(),c(T,{key:0,type:"primary",onClick:d[0]||(d[0]=b=>n(z).push({path:`/knowledge/document/upload/${n(C)}`,query:{id:n(u)}}))},{default:e(()=>[r(s(l.$t("views.document.uploadDocument")),1)]),_:1})):w("",!0),((Xe=B.value)==null?void 0:Xe.type)===1&&a.value.doc_create(n(u))?(o(),c(T,{key:1,type:"primary",onClick:Te},{default:e(()=>[r(s(l.$t("views.document.importDocument")),1)]),_:1})):w("",!0),((xe=B.value)==null?void 0:xe.type)===2&&a.value.doc_create(n(u))?(o(),c(T,{key:2,type:"primary",onClick:d[1]||(d[1]=b=>{var ce;return n(z).push({path:`/knowledge/import/${n(C)}`,query:{id:n(u),folder_token:(ce=B.value)==null?void 0:ce.meta.folder_token}})})},{default:e(()=>[r(s(l.$t("views.document.importDocument")),1)]),_:1})):w("",!0),a.value.doc_vector(n(u))?(o(),c(T,{key:3,onClick:Ct,disabled:_.value.length===0},{default:e(()=>[r(s(l.$t("views.knowledge.setting.vectorization")),1)]),_:1},8,["disabled"])):w("",!0),a.value.doc_generate(n(u))?(o(),c(T,{key:4,onClick:d[2]||(d[2]=b=>Ie()),disabled:_.value.length===0},{default:e(()=>[r(s(l.$t("views.document.generateQuestion.title")),1)]),_:1},8,["disabled"])):w("",!0),a.value.doc_edit(n(u))?(o(),c(T,{key:5,onClick:pt,disabled:_.value.length===0},{default:e(()=>[r(s(l.$t("common.setting")),1)]),_:1},8,["disabled"])):w("",!0),h(n(u))?(o(),c(De,{key:6},{dropdown:e(()=>[t(be,null,{default:e(()=>{var b,ce;return[a.value.doc_migrate(n(u))?(o(),c(P,{key:0,onClick:d[3]||(d[3]=Me=>ve()),disabled:_.value.length===0},{default:e(()=>[r(s(l.$t("views.document.setting.migration")),1)]),_:1},8,["disabled"])):w("",!0),a.value.doc_tag(n(u))?(o(),c(P,{key:1,onClick:d[4]||(d[4]=Me=>Bt()),disabled:_.value.length===0},{default:e(()=>[r(s(l.$t("views.document.tag.addTag")),1)]),_:1},8,["disabled"])):w("",!0),((b=B.value)==null?void 0:b.type)===1&&a.value.doc_sync(n(u))?(o(),c(P,{key:2,divided:"",onClick:bt,disabled:_.value.length===0},{default:e(()=>[r(s(l.$t("views.document.syncDocument")),1)]),_:1},8,["disabled"])):w("",!0),((ce=B.value)==null?void 0:ce.type)===2&&a.value.doc_sync(n(u))?(o(),c(P,{key:3,divided:"",onClick:wt,disabled:_.value.length===0},{default:e(()=>[r(s(l.$t("views.document.syncDocument")),1)]),_:1},8,["disabled"])):w("",!0),a.value.doc_delete(n(u))?(o(),c(P,{key:4,divided:"",onClick:$t,disabled:_.value.length===0},{default:e(()=>[r(s(l.$t("common.delete")),1)]),_:1},8,["disabled"])):w("",!0)]}),_:1})]),default:e(()=>[t(T,{class:"ml-12 mr-12"},{default:e(()=>[t(O,{iconName:"app-more"})]),_:1})]),_:1})):w("",!0)],64))]),S("div",jl,[S("div",Wl,[t(Gt,{class:"complex-search__left",modelValue:k.value,"onUpdate:modelValue":d[5]||(d[5]=b=>k.value=b),style:{width:"120px"},onChange:It},{default:e(()=>[t(Ze,{label:l.$t("dynamicsForm.tag.label"),value:"tag"},null,8,["label"]),t(Ze,{label:l.$t("views.tool.form.toolName.label"),value:"name"},null,8,["label"])]),_:1},8,["modelValue"]),k.value==="name"?(o(),c(Ye,{key:0,modelValue:A.value.name,"onUpdate:modelValue":d[6]||(d[6]=b=>A.value.name=b),onChange:Se,placeholder:l.$t("common.searchBar.placeholder"),style:{width:"220px"},clearable:""},null,8,["modelValue","placeholder"])):w("",!0),k.value==="tag"?(o(),c(Ye,{key:1,modelValue:A.value.tag,"onUpdate:modelValue":d[7]||(d[7]=b=>A.value.tag=b),onChange:Se,placeholder:l.$t("views.document.tag.requiredMessage3"),style:{width:"220px"},clearable:""},null,8,["modelValue","placeholder"])):w("",!0)]),a.value.tag_read(n(u))?(o(),c(T,{key:0,onClick:Lt,class:"ml-12"},{default:e(()=>[r(s(l.$t("views.document.tag.label")),1)]),_:1})):w("",!0)])]),Ge((o(),c(Ht,{ref_key:"multipleTableRef",ref:ee,class:"mt-16 document-table",data:y.value,"pagination-config":H.value,"quick-create":((et=B.value)==null?void 0:et.type)===0&&a.value.doc_create(n(u))&&!E.value,onSizeChange:Mt,onChangePage:se,onCellMouseEnter:Vt,onCellMouseLeave:Rt,onCreatQuick:kt,onRowClick:ht,onSelectionChange:mt,onSortChange:Nt,"row-key":b=>b.id,storeKey:we},{default:e(()=>[E.value?w("",!0):(o(),c(ye,{key:0,type:"selection",width:"55","reserve-selection":!0})),t(ye,{prop:"name",label:l.$t("views.document.table.name"),"min-width":"280"},{default:e(({row:b})=>[E.value?(o(),le("span",Hl,s(b.name),1)):(o(),c(Kt,{key:0,onChange:ce=>St(ce,b.id),data:b.name,showEditIcon:b.id===L.value},null,8,["onChange","data","showEditIcon"]))]),_:1},8,["label"]),t(ye,{prop:"status",label:l.$t("views.document.fileStatus.label"),width:"130"},{header:e(()=>[S("div",null,[S("span",null,s(l.$t("views.document.fileStatus.label")),1),t(De,{trigger:"click",onCommand:oe},{dropdown:e(()=>[t(be,{style:{width:"100px"}},{default:e(()=>[t(P,{class:_e([K.value.status?"":"is-active","justify-center"]),command:me("status","")},{default:e(()=>[r(s(l.$t("views.document.table.all")),1)]),_:1},8,["class","command"]),t(P,{class:_e([K.value.status===n(M).SUCCESS?"is-active":"","justify-center"]),command:me("status",n(M).SUCCESS)},{default:e(()=>[r(s(l.$t("views.document.fileStatus.SUCCESS")),1)]),_:1},8,["class","command"]),t(P,{class:_e([K.value.status===n(M).FAILURE?"is-active":"","justify-center"]),command:me("status",n(M).FAILURE)},{default:e(()=>[r(s(l.$t("views.document.fileStatus.FAILURE")),1)]),_:1},8,["class","command"]),t(P,{class:_e([K.value.status===n(M).STARTED&&K.value.task_type==n(J).EMBEDDING?"is-active":"","justify-center"]),command:me("status",n(M).STARTED,n(J).EMBEDDING)},{default:e(()=>[r(s(l.$t("views.document.fileStatus.EMBEDDING")),1)]),_:1},8,["class","command"]),t(P,{class:_e([K.value.status===n(M).PENDING?"is-active":"","justify-center"]),command:me("status",n(M).PENDING)},{default:e(()=>[r(s(l.$t("views.document.fileStatus.PENDING")),1)]),_:1},8,["class","command"]),t(P,{class:_e([K.value.status===n(M).STARTED&&K.value.task_type===n(J).GENERATE_PROBLEM?"is-active":"","justify-center"]),command:me("status",n(M).STARTED,n(J).GENERATE_PROBLEM)},{default:e(()=>[r(s(l.$t("views.document.fileStatus.GENERATE")),1)]),_:1},8,["class","command"])]),_:1})]),default:e(()=>[t(T,{style:{"margin-top":"1px"},link:"",type:K.value.status?"primary":""},{default:e(()=>[t(he,null,{default:e(()=>[t(Ae)]),_:1})]),_:1},8,["type"])]),_:1})])]),default:e(({row:b})=>[t(hl,{status:b.status,"status-meta":b.status_meta},null,8,["status","status-meta"])]),_:1},8,["label"]),t(ye,{prop:"char_length",label:l.$t("views.document.table.char_length"),align:"right","min-width":"90",sortable:""},{default:e(({row:b})=>[r(s(n(sl)(b.char_length)),1)]),_:1},8,["label"]),t(ye,{prop:"paragraph_count",label:l.$t("views.document.table.paragraph"),align:"right","min-width":"90",sortable:""},null,8,["label"]),t(ye,{width:"130"},{header:e(()=>[S("div",null,[S("span",null,s(l.$t("views.document.enableStatus.label")),1),t(De,{trigger:"click",onCommand:oe},{dropdown:e(()=>[t(be,{style:{width:"100px"}},{default:e(()=>[t(P,{class:_e([K.value.is_active===""?"is-active":"","justify-center"]),command:me("is_active","")},{default:e(()=>[r(s(l.$t("views.document.table.all")),1)]),_:1},8,["class","command"]),t(P,{class:_e([K.value.is_active===!0?"is-active":"","justify-center"]),command:me("is_active",!0)},{default:e(()=>[r(s(l.$t("common.status.enabled")),1)]),_:1},8,["class","command"]),t(P,{class:_e([K.value.is_active===!1?"is-active":"","justify-center"]),command:me("is_active",!1)},{default:e(()=>[r(s(l.$t("common.status.disabled")),1)]),_:1},8,["class","command"])]),_:1})]),default:e(()=>[t(T,{style:{"margin-top":"1px"},link:"",type:K.value.is_active?"primary":""},{default:e(()=>[t(he,null,{default:e(()=>[t(Ae)]),_:1})]),_:1},8,["type"])]),_:1})])]),default:e(({row:b})=>[b.is_active?(o(),le("div",Ql,[t(he,{class:"color-success mr-8",style:{"font-size":"16px"}},{default:e(()=>[t(Pt)]),_:1}),S("span",Zl,s(l.$t("common.status.enabled")),1)])):(o(),le("div",Yl,[t(O,{iconName:"app-disabled",class:"color-secondary mr-8"}),S("span",Jl,s(l.$t("common.status.disabled")),1)]))]),_:1}),t(ye,{width:"170"},{header:e(()=>[S("div",null,[S("span",null,s(l.$t("views.document.form.hit_handling_method.label")),1),t(De,{trigger:"click",onCommand:oe},{dropdown:e(()=>[t(be,{style:{width:"150px"}},{default:e(()=>[t(P,{class:_e([K.value.hit_handling_method?"":"is-active","justify-center"]),command:me("hit_handling_method","")},{default:e(()=>[r(s(l.$t("views.document.table.all")),1)]),_:1},8,["class","command"]),(o(!0),le(de,null,Ce(n(Ne),(b,ce)=>(o(),c(P,{key:ce,class:_e([K.value.hit_handling_method===ce?"is-active":"","justify-center"]),command:me("hit_handling_method",ce)},{default:e(()=>[r(s(l.$t(b)),1)]),_:2},1032,["class","command"]))),128))]),_:1})]),default:e(()=>[t(T,{style:{"margin-top":"1px"},link:"",type:K.value.hit_handling_method?"primary":""},{default:e(()=>[t(he,null,{default:e(()=>[t(Ae)]),_:1})]),_:1},8,["type"])]),_:1})])]),default:e(({row:b})=>[r(s(l.$t(n(Ne)[b.hit_handling_method])),1)]),_:1}),t(ye,{prop:"create_time",label:l.$t("common.createTime"),width:"175",sortable:""},{default:e(({row:b})=>[r(s(n(ot)(b.create_time)),1)]),_:1},8,["label"]),t(ye,{prop:"update_time",label:l.$t("views.document.table.updateTime"),width:"175",sortable:""},{default:e(({row:b})=>[r(s(n(ot)(b.update_time)),1)]),_:1},8,["label"]),E.value?w("",!0):(o(),c(ye,{key:1,label:l.$t("common.operation"),align:"left",width:"160",fixed:"right"},{default:e(({row:b})=>{var ce,Me,tt;return[S("span",{onClick:d[8]||(d[8]=x(()=>{},["stop"]))},[a.value.doc_edit(n(u))?(o(),c(qt,{key:0,loading:f.value,size:"small",modelValue:b.is_active,"onUpdate:modelValue":X=>b.is_active=X,"before-change":()=>Et(b)},null,8,["loading","modelValue","onUpdate:modelValue","before-change"])):w("",!0)]),t(Ot,{direction:"vertical"}),((ce=B.value)==null?void 0:ce.type)===0?(o(),le(de,{key:0},[[n(M).STARTED,n(M).PENDING].includes(U(b.status,n(J).EMBEDDING))?(o(),c(Ee,{key:0,effect:"dark",content:l.$t("views.document.setting.cancelVectorization"),placement:"top"},{default:e(()=>[S("span",Xl,[a.value.doc_vector(n(u))?(o(),c(T,{key:0,type:"primary",text:"",onClick:x(X=>ne(b,n(J).EMBEDDING),["stop"])},{default:e(()=>[t(he,null,{default:e(()=>[t(Ve)]),_:1})]),_:1},8,["onClick"])):w("",!0)])]),_:2},1032,["content"])):(o(),c(Ee,{key:1,effect:"dark",content:l.$t("views.knowledge.setting.vectorization"),placement:"top"},{default:e(()=>[a.value.doc_vector(n(u))?(o(),le("span",xl,[t(T,{type:"primary",text:"",onClick:x(X=>Pe(b),["stop"])},{default:e(()=>[t(O,{iconName:"app-document-refresh",style:{"font-size":"16px"}})]),_:1},8,["onClick"])])):w("",!0)]),_:2},1032,["content"])),a.value.doc_edit(n(u))?(o(),c(Ee,{key:2,effect:"dark",content:l.$t("common.setting"),placement:"top"},{default:e(()=>[S("span",ea,[t(T,{type:"primary",text:"",onClick:x(X=>Ke(b),["stop"])},{default:e(()=>[t(O,{iconName:"app-setting"})]),_:1},8,["onClick"])])]),_:2},1032,["content"])):w("",!0),S("span",{onClick:d[9]||(d[9]=x(()=>{},["stop"]))},[v(n(u))?(o(),c(De,{key:0,trigger:"click"},{dropdown:e(()=>[t(be,null,{default:e(()=>[[n(M).STARTED,n(M).PENDING].includes(U(b.status,n(J).GENERATE_PROBLEM))&&a.value.doc_generate(n(u))?(o(),c(P,{key:0,onClick:X=>ne(b,n(J).GENERATE_PROBLEM)},{default:e(()=>[t(he,{class:"color-secondary"},{default:e(()=>[t(Ve)]),_:1}),r(" "+s(l.$t("views.document.setting.cancelGenerateQuestion")),1)]),_:1},8,["onClick"])):a.value.doc_generate(n(u))?(o(),c(P,{key:1,onClick:X=>Ie(b)},{default:e(()=>[t(O,{iconName:"app-generate-question",class:"color-secondary"}),r(" "+s(l.$t("views.document.generateQuestion.title")),1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_tag(n(u))?(o(),c(P,{key:2,onClick:X=>Qe(b)},{default:e(()=>[t(O,{iconName:"app-tag",class:"color-secondary"}),r(" "+s(l.$t("views.document.tag.setting")),1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_migrate(n(u))?(o(),c(P,{key:3,onClick:X=>ve(b)},{default:e(()=>[t(O,{iconName:"app-migrate",class:"color-secondary"}),r(" "+s(l.$t("views.document.setting.migration")),1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_export(n(u))?(o(),c(P,{key:4,onClick:X=>te(b)},{default:e(()=>[t(O,{iconName:"app-export",class:"color-secondary"}),r(" "+s(l.$t("views.document.setting.export"))+" Excel ",1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_export(n(u))?(o(),c(P,{key:5,onClick:X=>fe(b)},{default:e(()=>[t(O,{iconName:"app-export",class:"color-secondary"}),r(" "+s(l.$t("views.document.setting.export"))+" Zip ",1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_download(n(u))?(o(),c(P,{key:6,onClick:x(X=>Tt(b),["stop"])},{default:e(()=>[t(he,{class:"color-secondary"},{default:e(()=>[t(zt)]),_:1}),r(" "+s(l.$t("views.document.setting.download")),1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_replace(n(u))?(o(),c(Wt,{key:7,ref_key:"elUploadRef",ref:qe,"file-list":[],action:"#","auto-upload":!1,"show-file-list":!1,"on-change":(X,sa)=>Dt(X,b)},{default:e(()=>[t(P,null,{default:e(()=>[t(he,{class:"color-secondary"},{default:e(()=>[t(jt)]),_:1}),r(" "+s(l.$t("views.document.setting.replace")),1)]),_:1})]),_:1},8,["on-change"])):w("",!0),a.value.doc_delete(n(u))?(o(),c(P,{key:8,onClick:x(X=>Oe(b),["stop"])},{default:e(()=>[t(O,{iconName:"app-delete",class:"color-secondary"}),r(" "+s(l.$t("common.delete")),1)]),_:1},8,["onClick"])):w("",!0)]),_:2},1024)]),default:e(()=>[t(T,{text:"",type:"primary"},{default:e(()=>[t(O,{iconName:"app-more"})]),_:1})]),_:2},1024)):w("",!0)])],64)):w("",!0),((Me=B.value)==null?void 0:Me.type)===1||((tt=B.value)==null?void 0:tt.type)===2?(o(),le(de,{key:1},[[n(M).STARTED,n(M).PENDING].includes(U(b.status,n(J).EMBEDDING))&&a.value.doc_vector(n(u))?(o(),c(Ee,{key:0,effect:"dark",content:l.$t("views.document.setting.cancelVectorization"),placement:"top"},{default:e(()=>[S("span",ta,[t(T,{type:"primary",text:"",onClick:x(X=>ne(b,n(J).EMBEDDING),["stop"])},{default:e(()=>[t(he,null,{default:e(()=>[t(Ve)]),_:1})]),_:1},8,["onClick"])])]),_:2},1032,["content"])):w("",!0),a.value.vector(n(u))?(o(),c(Ee,{key:1,effect:"dark",content:l.$t("views.knowledge.setting.vectorization"),placement:"top"},{default:e(()=>[S("span",la,[t(T,{type:"primary",text:"",onClick:x(X=>Pe(b),["stop"])},{default:e(()=>[t(O,{iconName:"app-document-refresh",style:{"font-size":"16px"}})]),_:1},8,["onClick"])])]),_:2},1032,["content"])):w("",!0),a.value.doc_edit(n(u))?(o(),c(Ee,{key:2,effect:"dark",content:l.$t("common.setting"),placement:"top"},{default:e(()=>[S("span",aa,[t(T,{type:"primary",text:"",onClick:x(X=>Ke(b),["stop"])},{default:e(()=>[t(O,{iconName:"app-setting"})]),_:1},8,["onClick"])])]),_:2},1032,["content"])):w("",!0),S("span",{onClick:d[10]||(d[10]=x(()=>{},["stop"]))},[R(n(u))?(o(),c(De,{key:0,trigger:"click"},{dropdown:e(()=>[t(be,null,{default:e(()=>[a.value.sync(n(u))?(o(),c(P,{key:0,onClick:X=>_t(b)},{default:e(()=>[t(O,{iconName:"app-sync",class:"color-secondary"}),r(" "+s(l.$t("views.knowledge.setting.sync")),1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_tag(n(u))?(o(),c(P,{key:1,onClick:X=>Qe(b)},{default:e(()=>[t(O,{iconName:"app-tag",class:"color-secondary"}),r(" "+s(l.$t("views.document.tag.setting")),1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_generate(n(u))&&[n(M).STARTED,n(M).PENDING].includes(U(b.status,n(J).GENERATE_PROBLEM))?(o(),c(P,{key:2,onClick:X=>ne(b,n(J).GENERATE_PROBLEM)},{default:e(()=>[t(he,{class:"color-secondary"},{default:e(()=>[t(Ve)]),_:1}),r(" "+s(l.$t("views.document.setting.cancelGenerateQuestion")),1)]),_:1},8,["onClick"])):a.value.doc_generate(n(u))?(o(),c(P,{key:3,onClick:X=>Ie(b)},{default:e(()=>[t(O,{iconName:"app-generate-question",class:"color-secondary"}),r(" "+s(l.$t("views.document.generateQuestion.title")),1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_migrate(n(u))?(o(),c(P,{key:4,onClick:X=>ve(b)},{default:e(()=>[t(O,{iconName:"app-migrate",class:"color-secondary"}),r(" "+s(l.$t("views.document.setting.migration")),1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_export(n(u))?(o(),c(P,{key:5,onClick:X=>te(b)},{default:e(()=>[t(O,{iconName:"app-export",class:"color-secondary"}),r(" "+s(l.$t("views.document.setting.export"))+" Excel ",1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_export(n(u))?(o(),c(P,{key:6,onClick:X=>fe(b)},{default:e(()=>[t(O,{iconName:"app-export",class:"color-secondary"}),r(" "+s(l.$t("views.document.setting.export"))+" Zip ",1)]),_:1},8,["onClick"])):w("",!0),a.value.doc_delete(n(u))?(o(),c(P,{key:7,onClick:x(X=>Oe(b),["stop"])},{default:e(()=>[t(O,{iconName:"app-delete",class:"color-secondary"}),r(" "+s(l.$t("common.delete")),1)]),_:1},8,["onClick"])):w("",!0)]),_:2},1024)]),default:e(()=>[t(T,{text:"",type:"primary"},{default:e(()=>[t(O,{iconName:"app-more"})]),_:1})]),_:2},1024)):w("",!0)])],64)):w("",!0)]}),_:1},8,["label"]))]),_:1},8,["data","pagination-config","quick-create","row-key"])),[[Yt,f.value]])])])]}),_:1}),_.value.length!==0?(o(),le("div",oa,[a.value.doc_vector(n(u))?(o(),c(T,{key:0,disabled:_.value.length===0,onClick:d[11]||(d[11]=Re=>pe(1))},{default:e(()=>[r(s(l.$t("views.document.setting.cancelVectorization")),1)]),_:1},8,["disabled"])):w("",!0),a.value.doc_generate(n(u))?(o(),c(T,{key:1,disabled:_.value.length===0,onClick:d[12]||(d[12]=Re=>pe(2))},{default:e(()=>[r(s(l.$t("views.document.setting.cancelGenerate")),1)]),_:1},8,["disabled"])):w("",!0),t(Zt,{type:"info",class:"secondary ml-24"},{default:e(()=>[r(s(l.$t("common.selected"))+" "+s(_.value.length)+" "+s(l.$t("views.document.items")),1)]),_:1}),t(T,{class:"ml-16",type:"primary",link:"",onClick:ie},{default:e(()=>[r(s(l.$t("common.clear")),1)]),_:1})])):w("",!0),t(bl,{ref_key:"embeddingContentDialogRef",ref:G},null,512),t(vl,{ref_key:"ImportDocumentDialogRef",ref:q,title:D.value,onRefresh:Se},null,8,["title"]),t(il,{ref_key:"SyncWebDialogRef",ref:m,onRefresh:Se},null,512),t(gl,{ref_key:"selectKnowledgeDialogRef",ref:ae,onRefresh:At,workspaceId:(Je=B.value)==null?void 0:Je.workspace_id},null,8,["workspaceId"]),t(cl,{ref_key:"GenerateRelatedDialogRef",ref:je,onRefresh:se,apiType:p.value},null,8,["apiType"]),t(Il,{ref_key:"tagDrawerRef",ref:We},null,512),t(Gl,{ref_key:"tagSettingDrawerRef",ref:He},null,512),t(dt,{ref_key:"addTagDialogRef",ref:Ue,onAddTags:Ft,apiType:p.value},null,8,["apiType"])])}}}),ma=it(na,[["__scopeId","data-v-3137ca11"]]);export{ma as default};
