import{ay as ee,b8 as le,b7 as K,b9 as te,aB as h,bd as ae,aC as d,br as oe,aD as p,bs as se,bf as I,aF as r,aI as s,aH as o,aJ as c,aG as a,bt as ie,aE as v,bm as m,cm as ne,aK as S,cn as re,co as ue,bn as E,c6 as de,bc as k,bo as z,ce as pe}from"./chat-CUfIjAsy.js";import{_ as ce}from"./BaseForm.vue_vue_type_script_setup_true_lang-DJo6VgV9.js";const me={class:"p-16-24"},_e={class:"mb-16"},ve={class:"knowledge-setting main-calc-height"},fe={class:"p-24"},ge={class:"title-decoration-1 mb-16"},we={class:"flex align-center"},ye={class:"flex align-center"},ke={class:"flex align-center"},be={key:5},he={class:"title-decoration-1 mb-16"},Ve={class:"flex align-center"},$e={class:"mr-4"},Se={class:"text-right"},Te=ee({__name:"KnowledgeSetting",setup(ze){const T=le(),{params:{id:f,folderId:L}}=T,_=K(()=>T.path.includes("shared")?"systemShare":T.path.includes("resource-management")?"systemManage":"workspace"),j=K(()=>te.knowledge[_.value]),G=K(()=>L==="share"),A=h(),V=h(),b=h(!1),i=h({}),q=h(""),t=h({source_url:"",selector:"",app_id:"",app_secret:"",folder_token:"",file_count_limit:50,file_size_limit:100}),H=ae({source_url:[{required:!0,message:d("views.knowledge.form.source_url.requiredMessage"),trigger:"blur"}],app_id:[{required:!0,message:d("views.application.applicationAccess.larkSetting.appIdPlaceholder"),trigger:"blur"}],app_secret:[{required:!0,message:d("views.application.applicationAccess.larkSetting.appSecretPlaceholder"),trigger:"blur"}],folder_token:[{required:!0,message:d("views.application.applicationAccess.larkSetting.folderTokenPlaceholder"),trigger:"blur"}]});async function J(){var e;await((e=V.value)==null?void 0:e.validate())&&await A.value.validate(l=>{if(l){const u=i.value.type===1||i.value.type===2?{meta:t.value,file_count_limit:t.value.file_count_limit,file_size_limit:t.value.file_size_limit,...V.value.form}:{file_count_limit:t.value.file_count_limit,file_size_limit:t.value.file_size_limit,...V.value.form};q.value!==V.value.form.embedding_model_id?de(d("common.tip"),d("views.knowledge.tip.updateModeMessage"),{confirmButtonText:d("views.knowledge.setting.vectorization")}).then(()=>{i.value.type===2?k({type:"knowledge",systemType:_.value}).putLarkKnowledge(f,u,b).then(()=>{k({type:"knowledge",systemType:_.value}).putReEmbeddingKnowledge(f).then(()=>{z(d("common.saveSuccess"))})}):k({type:"knowledge",systemType:_.value}).putKnowledge(f,u,b).then(()=>{k({type:"knowledge",systemType:_.value}).putReEmbeddingKnowledge(f).then(()=>{z(d("common.saveSuccess"))})})}).catch(()=>{}):i.value.type===2?k({type:"knowledge",systemType:_.value}).putLarkKnowledge(f,u,b).then(()=>{z(d("common.saveSuccess"))}):k({type:"knowledge",systemType:_.value}).putKnowledge(f,u,b).then(()=>{z(d("common.saveSuccess"))})}})}function O(){k({type:"knowledge",isShared:G.value,systemType:_.value}).getKnowledgeDetail(f,b).then(e=>{var l,u,w,y;i.value=e.data,q.value=(l=e.data)==null?void 0:l.embedding_model_id,((u=i.value)==null?void 0:u.type)===0&&(t.value.file_count_limit=e.data.file_count_limit,t.value.file_size_limit=e.data.file_size_limit),(((w=i.value)==null?void 0:w.type)===1||((y=i.value)==null?void 0:y.type)===2)&&(t.value=e.data.meta)})}return oe(()=>{O()}),(e,l)=>{const u=p("el-avatar"),w=p("el-text"),y=p("el-card"),g=p("el-form-item"),$=p("el-input"),B=p("el-slider"),Q=p("AppIcon"),W=p("el-tooltip"),X=p("el-form"),Y=p("el-button"),Z=p("el-scrollbar"),x=se("loading");return r(),I("div",me,[s("h2",_e,c(e.$t("common.setting")),1),o(y,{style:{"--el-card-padding":"0"}},{default:a(()=>[s("div",ve,[o(Z,null,{default:a(()=>[ie((r(),I("div",fe,[s("h4",ge,c(e.$t("common.info")),1),o(ce,{ref_key:"BaseFormRef",ref:V,data:i.value,apiType:_.value},null,8,["data","apiType"]),o(X,{ref_key:"webFormRef",ref:A,rules:H,model:t.value,"label-position":"top","require-asterisk-position":"right"},{default:a(()=>{var M,C,D,P,R,U;return[o(g,{label:e.$t("views.knowledge.knowledgeType.label"),required:""},{default:a(()=>{var n,F,N;return[((n=i.value)==null?void 0:n.type)===0?(r(),v(y,{key:0,shadow:"never",class:"mb-8 w-full layout-bg",style:{"line-height":"22px"}},{default:a(()=>[s("div",we,[o(u,{class:"mr-8 avatar-blue",shape:"square",size:32},{default:a(()=>[...l[9]||(l[9]=[s("img",{src:ne,style:{width:"58%"},alt:""},null,-1)])]),_:1}),s("div",null,[s("div",null,c(e.$t("views.knowledge.knowledgeType.generalKnowledge")),1),o(w,{type:"info"},{default:a(()=>[S(c(e.$t("views.knowledge.knowledgeType.generalInfo")),1)]),_:1})])])]),_:1})):m("",!0),((F=i.value)==null?void 0:F.type)===1?(r(),v(y,{key:1,shadow:"never",class:"mb-8 w-full layout-bg",style:{"line-height":"22px"}},{default:a(()=>[s("div",ye,[o(u,{class:"mr-8 avatar-purple",shape:"square",size:32},{default:a(()=>[...l[10]||(l[10]=[s("img",{src:re,style:{width:"58%"},alt:""},null,-1)])]),_:1}),s("div",null,[s("div",null,c(e.$t("views.knowledge.knowledgeType.webKnowledge")),1),o(w,{type:"info"},{default:a(()=>[S(c(e.$t("views.knowledge.knowledgeType.webInfo")),1)]),_:1})])])]),_:1})):m("",!0),((N=i.value)==null?void 0:N.type)===2?(r(),v(y,{key:2,shadow:"never",class:"mb-8 w-full layout-bg",style:{"line-height":"22px"}},{default:a(()=>[s("div",ke,[o(u,{shape:"square",size:32,style:{background:"none"}},{default:a(()=>[...l[11]||(l[11]=[s("img",{src:ue,style:{width:"100%"},alt:""},null,-1)])]),_:1}),s("div",null,[s("p",null,[o(w,null,{default:a(()=>[S(c(e.$t("views.knowledge.knowledgeType.larkKnowledge")),1)]),_:1})]),o(w,{type:"info"},{default:a(()=>[S(c(e.$t("views.knowledge.knowledgeType.larkInfo")),1)]),_:1})])])]),_:1})):m("",!0)]}),_:1},8,["label"]),((M=i.value)==null?void 0:M.type)===1?(r(),v(g,{key:0,label:e.$t("views.knowledge.form.source_url.label"),prop:"source_url"},{default:a(()=>[o($,{modelValue:t.value.source_url,"onUpdate:modelValue":l[0]||(l[0]=n=>t.value.source_url=n),placeholder:e.$t("views.knowledge.form.source_url.placeholder"),onBlur:l[1]||(l[1]=n=>t.value.source_url=t.value.source_url.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):m("",!0),((C=i.value)==null?void 0:C.type)===1?(r(),v(g,{key:1,label:e.$t("views.knowledge.form.selector.label")},{default:a(()=>[o($,{modelValue:t.value.selector,"onUpdate:modelValue":l[2]||(l[2]=n=>t.value.selector=n),placeholder:e.$t("views.knowledge.form.selector.placeholder"),onBlur:l[3]||(l[3]=n=>t.value.selector=t.value.selector.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):m("",!0),((D=i.value)==null?void 0:D.type)===2?(r(),v(g,{key:2,label:"App ID",prop:"app_id"},{default:a(()=>[o($,{modelValue:t.value.app_id,"onUpdate:modelValue":l[4]||(l[4]=n=>t.value.app_id=n),placeholder:e.$t("views.application.applicationAccess.larkSetting.appIdPlaceholder")},null,8,["modelValue","placeholder"])]),_:1})):m("",!0),((P=i.value)==null?void 0:P.type)===2?(r(),v(g,{key:3,label:"App Secret",prop:"app_id"},{default:a(()=>[o($,{modelValue:t.value.app_secret,"onUpdate:modelValue":l[5]||(l[5]=n=>t.value.app_secret=n),type:"password","show-password":"",placeholder:e.$t("views.application.applicationAccess.larkSetting.appSecretPlaceholder")},null,8,["modelValue","placeholder"])]),_:1})):m("",!0),((R=i.value)==null?void 0:R.type)===2?(r(),v(g,{key:4,label:"Folder Token",prop:"folder_token"},{default:a(()=>[o($,{modelValue:t.value.folder_token,"onUpdate:modelValue":l[6]||(l[6]=n=>t.value.folder_token=n),placeholder:e.$t("views.application.applicationAccess.larkSetting.folderTokenPlaceholder")},null,8,["modelValue","placeholder"])]),_:1})):m("",!0),((U=i.value)==null?void 0:U.type)===0?(r(),I("div",be,[s("h4",he,c(e.$t("common.otherSetting")),1),o(g,{label:e.$t("views.knowledge.form.file_count_limit.label")},{default:a(()=>[o(B,{modelValue:t.value.file_count_limit,"onUpdate:modelValue":l[7]||(l[7]=n=>t.value.file_count_limit=n),"show-input":"","show-input-controls":!1,min:1,max:1e3,class:"custom-slider"},null,8,["modelValue"])]),_:1},8,["label"]),o(g,null,{label:a(()=>[s("div",Ve,[s("span",$e,c(e.$t("views.knowledge.form.file_size_limit.label")),1),o(W,{effect:"dark",content:e.$t("views.knowledge.form.file_size_limit.placeholder"),placement:"right"},{default:a(()=>[o(Q,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:a(()=>[o(B,{modelValue:t.value.file_size_limit,"onUpdate:modelValue":l[8]||(l[8]=n=>t.value.file_size_limit=n),"show-input":"","show-input-controls":!1,min:1,max:1e3,class:"custom-slider"},null,8,["modelValue"])]),_:1})])):m("",!0)]}),_:1},8,["rules","model"]),s("div",Se,[!E(T).path.includes("share/")&&j.value.edit(E(f))?(r(),v(Y,{key:0,onClick:J,type:"primary"},{default:a(()=>[S(c(e.$t("common.save")),1)]),_:1})):m("",!0)])])),[[x,b.value]])]),_:1})])]),_:1})])}}}),Ae=pe(Te,[["__scopeId","data-v-f9fd0fb0"]]);export{Ae as default};
