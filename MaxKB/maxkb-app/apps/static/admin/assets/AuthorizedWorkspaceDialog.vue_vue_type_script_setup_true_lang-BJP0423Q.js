import{b0 as x,a_ as I,ay as Z,aB as p,aO as ee,aD as i,b7 as oe,aE as T,aF as _,aG as a,aI as c,aH as l,b8 as te,aJ as s,aK as h,aW as y,b1 as ae,aX as H,aY as U}from"./admin-Ca7cl6NN.js";import{l as le}from"./permission-api-BDoWsP34.js";const v="/system/shared",se=(r,n)=>I(`${v}/knowledge/${r}/authorization`,{},n),ne=(r,n,u)=>x(`${v}/knowledge/${r}/authorization`,n,u),ie=(r,n)=>I(`${v}/tool/${r}/authorization`,{},n),re=(r,n,u)=>x(`${v}/tool/${r}/authorization`,n,u),ce=(r,n)=>I(`${v}/model/${r}/authorization`,{},n),de=(r,n,u)=>x(`${v}/model/${r}/authorization`,n,u),F={getSharedAuthorizationKnowledge:se,postSharedAuthorizationKnowledge:ne,getSharedAuthorizationTool:ie,postSharedAuthorizationTool:re,getSharedAuthorizationModel:ce,postSharedAuthorizationModel:de},ue={class:"mb-8"},pe={class:"mb-8 lighter"},_e={class:"mb-8 lighter mt-16"},he={class:"flex border",style:{overflow:"hidden"}},me={class:"border-r"},ve={class:"mt-8"},ke={class:"flex"},fe=["title"],ge={class:"w-full"},we={class:"flex-between p-16"},$e={class:"lighter"},be={class:"flex align-center"},ye=["title"],Ae=Z({__name:"AuthorizedWorkspaceDialog",setup(r,{expose:n}){const u=p(!1),C=p(!0),d=p([]),m=p([]),f=p("WHITE_LIST"),g=p("");let W="",L="Knowledge";const z=p(!1),k=p(!1),M=ee(()=>m.value.filter(e=>e.name.includes(g.value))),P=e=>{d.value=e?m.value:[],C.value=!1,e||K()},V=e=>{const o=e.length;u.value=o===m.value.length,C.value=o>0&&o<m.value.length},G=async({id:e},o="Knowledge")=>{W=e,z.value=!0,L=o;const[w,$]=await Promise.all([F[`getSharedAuthorization${o}`](e),le("workspace").getSystemWorkspaceList()]);m.value=$.data,f.value=(w.data||{}).authentication_type||"WHITE_LIST";const A=(w.data||{}).workspace_id_list||[];d.value=m.value.filter(S=>A.includes(S.id)),V(d.value),z.value=!1,k.value=!0},J=()=>{F[`postSharedAuthorization${L}`](W,{workspace_id_list:d.value.map(e=>e.id),authentication_type:f.value}).then(()=>{k.value=!1})},O=e=>{d.value=d.value.filter(o=>o.id!==e.id)},K=()=>{d.value=[],V([])};return n({open:G}),(e,o)=>{const w=i("el-text"),$=i("el-radio"),A=i("el-radio-group"),S=i("Search"),B=i("el-icon"),X=i("el-input"),D=i("el-checkbox"),E=i("AppIcon"),Y=i("el-checkbox-group"),N=i("el-scrollbar"),b=i("el-button"),j=i("Close"),q=i("el-dialog"),Q=oe("loading");return _(),T(q,{"modal-class":"authorized-workspace",modelValue:k.value,"onUpdate:modelValue":o[5]||(o[5]=t=>k.value=t),width:"840"},{header:a(()=>[c("h4",ue,s(e.$t("views.shared.authorized_workspace")),1),l(w,{class:"color-secondary lighter"},{default:a(()=>[h(s(e.$t("views.shared.authorized_tip")),1)]),_:1})]),footer:a(()=>[l(b,{onClick:o[4]||(o[4]=t=>k.value=!1)},{default:a(()=>[h(s(e.$t("common.cancel")),1)]),_:1}),l(b,{type:"primary",onClick:J},{default:a(()=>[h(s(e.$t("common.save")),1)]),_:1})]),default:a(()=>[c("p",pe,s(e.$t("views.shared.type")),1),l(A,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=t=>f.value=t)},{default:a(()=>[l($,{value:"WHITE_LIST"},{default:a(()=>[h(s(e.$t("views.shared.WHITE_LIST")),1)]),_:1}),l($,{value:"BLACK_LIST"},{default:a(()=>[h(s(e.$t("views.shared.BLACK_LIST")),1)]),_:1})]),_:1},8,["modelValue"]),c("p",_e,s(e.$t("views.shared.select_workspace")),1),te((_(),y("div",he,[c("div",me,[l(X,{modelValue:g.value,"onUpdate:modelValue":o[1]||(o[1]=t=>g.value=t),"validate-event":!1,placeholder:e.$t("common.search"),style:{width:"364px",padding:"16px 16px 0 16px"},clearable:""},{prefix:a(()=>[l(B,null,{default:a(()=>[l(S)]),_:1})]),_:1},8,["modelValue","placeholder"]),c("div",ve,[g.value?ae("",!0):(_(),T(D,{key:0,class:"mb-8",style:{"margin-left":"16px"},modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=t=>u.value=t),indeterminate:C.value,onChange:P},{default:a(()=>[h(s(e.$t("views.shared.allCheck")),1)]),_:1},8,["modelValue","indeterminate"])),l(N,{"max-height":"205","wrap-class":"p-16 pt-0"},{default:a(()=>[l(Y,{class:"checkbox-group-block",modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=t=>d.value=t),onChange:V},{default:a(()=>[(_(!0),y(H,null,U(M.value,t=>(_(),T(D,{key:t.id,label:t.name,value:t},{default:a(()=>[c("div",ke,[l(E,{iconName:"app-workspace"}),c("span",{class:"ml-4 ellipsis",title:t.name},s(t.name),9,fe)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),c("div",ge,[c("div",we,[c("span",$e,s(e.$t("common.selected"))+": "+s(d.value.length)+" ä¸ª ",1),l(b,{onClick:K,link:"",type:"primary"},{default:a(()=>[h(s(e.$t("common.clear")),1)]),_:1})]),l(N,{"max-height":"250","wrap-class":"p-16 pt-0"},{default:a(()=>[(_(!0),y(H,null,U(d.value,(t,R)=>(_(),y("div",{key:R,class:"flex-between"},[c("div",be,[l(E,{iconName:"app-workspace"}),c("span",{class:"ml-4 lighter ellipsis",title:t.name},s(t.name),9,ye)]),l(b,{link:""},{default:a(()=>[l(B,{onClick:Ce=>O(t),size:18},{default:a(()=>[l(j)]),_:1},8,["onClick"])]),_:2},1024)]))),128))]),_:1})])])),[[Q,z.value]])]),_:1},8,["modelValue"])}}});export{Ae as _};
