import{bk as ye,bj as ve,ay as F,aA as te,b7 as Q,aB as R,be as ue,aC as E,aD as i,bs as pe,aE as v,aF as u,cf as Y,aG as o,bt as de,aI as n,bf as W,bm as $,aJ as l,aK as C,bn as e,dH as ae,bW as B,bY as b,b_ as X,aH as t,b8 as _e,ci as le,bb as ee,c3 as ge,c6 as be,bo as ie,az as me,br as he,bg as q,cz as re,bX as H,bZ as Z,bh as ke,cV as Ae,ce as oe,dI as we,dJ as $e,dK as Ie,cs as Ce}from"./chat-CUfIjAsy.js";import{_ as Ee}from"./ResetPassword.vue_vue_type_script_setup_true_lang-Dm-TSE9c.js";import{_ as Re,s as j}from"./SettingAPIKeyDialog.vue_vue_type_script_setup_true_lang-BO2T52qZ.js";const fe="/license",xe=P=>ve(`${fe}/profile`,void 0,P),De=(P,s)=>ye(`${fe}/profile`,P,void 0,s),ce={getLicense:xe,putLicense:De},Se=["id"],Ne={class:"about-ui"},Pe={class:"flex"},Ke={class:"label"},Oe={class:"flex"},Te={class:"label"},Ue={key:0,class:"color-danger"},Me={class:"flex"},Ve={class:"label"},Le={class:"flex"},Be={class:"label"},We={class:"flex"},ze={class:"label"},Ge={class:"flex"},Fe={class:"label"},Xe={key:0,class:"mt-16 flex align-center"},He={class:"border-t text-center mt-16 p-16 pb-0"},je=F({__name:"AboutDialog",setup(P,{expose:s}){const{user:m,theme:d}=te(),g=Q(()=>d.isDefaultTheme()),y=R(!1),h=R(!1),f=R(null),I=R(!1);ue(y,c=>{c||(I.value&&window.location.reload(),I.value=!1)});const x=()=>{m.showXpack()&&D(),y.value=!0},T=c=>{const a=new FormData;a.append("license_file",c.raw),ce.putLicense(a,h).then(p=>{D(),I.value=!0})},U=Q(()=>m?m.getEditionName()==="PE"?E("layout.about.edition.professional"):m.getEditionName()==="EE"?E("layout.about.edition.enterprise"):E("layout.about.edition.community"):"-");function D(){ce.getLicense(h).then(c=>{var a;f.value=(a=c.data)==null?void 0:a.license})}return s({open:x}),(c,a)=>{const p=i("LogoFull"),K=i("el-button"),r=i("el-upload"),k=i("el-text"),O=i("el-dialog"),A=pe("loading");return u(),v(O,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=w=>y.value=w),class:Y(["about-dialog border-r-6",g.value?"":"dialog-custom-header"])},{header:o(({titleId:w,titleClass:M})=>[n("div",{class:Y(["logo flex-center",M]),id:w},[t(p,{height:"59px"})],10,Se)]),default:o(()=>{var w,M,S,z,V,N,G;return[de((u(),W("div",Ne,[n("div",Pe,[n("span",Ke,l(c.$t("layout.about.authorize")),1),n("span",null,l(((w=f.value)==null?void 0:w.corporation)||"-"),1)]),n("div",Oe,[n("span",Te,l(c.$t("layout.about.expiredTime")),1),n("span",null,[C(l(((M=f.value)==null?void 0:M.expired)||"-")+" ",1),(S=f.value)!=null&&S.expired&&e(ae)((z=f.value)==null?void 0:z.expired)?(u(),W("span",Ue,"（"+l(e(ae)((V=f.value)==null?void 0:V.expired))+"）",1)):$("",!0)])]),n("div",Me,[n("span",Ve,l(c.$t("layout.about.edition.label")),1),n("span",null,l(U.value),1)]),n("div",Le,[n("span",Be,l(c.$t("layout.about.version")),1),n("span",null,l(e(m).version),1)]),n("div",We,[n("span",ze,l(c.$t("layout.about.serialNo")),1),n("span",null,l(((N=f.value)==null?void 0:N.serialNo)||"-"),1)]),n("div",Ge,[n("span",Fe,l(c.$t("layout.about.remark")),1),n("span",null,l(((G=f.value)==null?void 0:G.remark)||"-"),1)]),e(m).showXpack()?(u(),W("div",Xe,[e(B)([e(b).ADMIN,e(X).ABOUT_UPDATE],"OR")?(u(),v(r,{key:0,ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":T},{default:o(()=>[t(K,{class:"border-primary mr-16"},{default:o(()=>[C(l(c.$t("layout.about.update"))+" License ",1)]),_:1})]),_:1},512)):$("",!0)])):$("",!0)])),[[A,h.value]]),n("div",He,[t(k,{type:"info"},{default:o(()=>[C(l(c.$t("layout.copyright")),1)]),_:1})])]}),_:1},8,["modelValue","class"])}}}),Ye={style:{"margin-top":"10px"}},Je={class:"vertical-middle lighter break-all"},qe={class:"mr-4"},Ze=F({__name:"APIKeyDialog",props:{userId:{type:String,default:""}},emits:["addData"],setup(P,{expose:s,emit:m}){const d=_e(),{params:{id:g}}=d,y=window.location.origin+`${window.MaxKB.prefix}/api-doc/`,h=R(),f=R(!1),I=R(!1),x=R(null);ue(f,r=>{r||(x.value=null)});function T(r){h.value.open(r,"USER")}function U(r){be(`${E("views.applicationOverview.appInfo.APIKeyDialog.msgConfirm1")}: ${r.secret_key}?`,E(E("views.applicationOverview.appInfo.APIKeyDialog.msgConfirm2")),{confirmButtonText:E("common.confirm"),cancelButtonText:E("common.cancel"),confirmButtonClass:"danger"}).then(()=>{j.delAPIKey(r.id,I).then(()=>{ie(E("common.deleteSuccess")),p()})}).catch(()=>{})}function D(r,k){const O={is_active:r},A=r?E("common.status.enabled"):E("common.status.disabled");j.putAPIKey(k.id,O,I).then(w=>{ie(A),p()})}function c(){j.postAPIKey(I).then(r=>{p()})}const a=()=>{p(),f.value=!0};function p(){j.getAPIKey().then(r=>{r.data.sort((k,O)=>k.name<O.name?1:-1),x.value=r.data})}function K(){p()}return s({open:a}),(r,k)=>{const O=i("el-text"),A=i("AppIcon"),w=i("el-button"),M=i("el-card"),S=i("el-table-column"),z=i("el-switch"),V=i("el-tooltip"),N=i("el-table"),G=i("el-dialog");return u(),v(G,{title:r.$t("layout.apiKey"),modelValue:f.value,"onUpdate:modelValue":k[2]||(k[2]=_=>f.value=_),width:"800","close-on-click-modal":!1,"close-on-press-escape":!1},{default:o(()=>[t(M,{shadow:"never",class:"layout-bg mb-16"},{default:o(()=>[t(O,{type:"info",class:"color-secondary"},{default:o(()=>[C(l(r.$t("layout.apiServiceAddress")),1)]),_:1}),n("p",Ye,[n("span",{class:"vertical-middle lighter break-all"},l(y)),t(w,{type:"primary",text:"",onClick:k[0]||(k[0]=_=>e(le)(y))},{default:o(()=>[t(A,{iconName:"app-copy"})]),_:1})])]),_:1}),t(w,{type:"primary",class:"mb-16",onClick:c},{default:o(()=>[C(l(r.$t("common.create")),1)]),_:1}),t(N,{data:x.value,class:"mb-16",loading:I.value},{default:o(()=>[t(S,{prop:"secret_key",label:"API Key"},{default:o(({row:_})=>[n("span",Je,l(_.secret_key),1),t(w,{type:"primary",text:"",onClick:L=>e(le)(_.secret_key)},{default:o(()=>[t(A,{iconName:"app-copy"})]),_:1},8,["onClick"])]),_:1}),t(S,{label:r.$t("common.status.label"),width:"80"},{default:o(({row:_})=>[n("div",{onClick:k[1]||(k[1]=ee(()=>{},["stop"]))},[t(z,{size:"small",modelValue:_.is_active,"onUpdate:modelValue":L=>_.is_active=L,onChange:L=>D(L,_)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),_:1},8,["label"]),t(S,{prop:"name",label:r.$t("common.createDate"),width:"170"},{default:o(({row:_})=>[C(l(e(ge)(_.create_time)),1)]),_:1},8,["label"]),t(S,{label:r.$t("common.setting"),align:"left",width:"80"},{default:o(({row:_})=>[n("span",qe,[t(V,{effect:"dark",content:r.$t("common.setting"),placement:"top"},{default:o(()=>[t(w,{type:"primary",text:"",onClick:ee(L=>T(_),["stop"])},{default:o(()=>[t(A,{iconName:"app-setting"})]),_:1},8,["onClick"])]),_:2},1032,["content"])]),t(V,{effect:"dark",content:r.$t("common.delete"),placement:"top"},{default:o(()=>[t(w,{type:"primary",text:"",onClick:L=>U(_)},{default:o(()=>[t(A,{iconName:"app-delete"})]),_:1},8,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data","loading"]),t(Re,{ref_key:"SettingAPIKeyDialogRef",ref:h,onRefresh:K},null,512)]),_:1},8,["title","modelValue"])}}}),Qe={class:"flex-center cursor"},et={class:"ml-8 color-text-primary"},tt={class:"userInfo flex align-center"},ot={class:"mr-12 flex align-center"},nt={style:{width:"90%"}},st={class:"bold mb-4",style:{"font-size":"14px"}},at={class:"flex-between w-full"},lt={class:"flex-between w-full",style:{"line-height":"22px",padding:"12px 11px"}},it=F({__name:"index",setup(P){const{user:s,login:m}=te(),d=me(),g=R(),y=R(),h=R(),f=a=>{s.postUserLanguage(a)},I=()=>{var a;(a=g.value)==null||a.open()};function x(){y.value.open()}const T=()=>{var a;(a=h.value)==null||a.open()},U={系统管理员:"layout.about.inner_admin",工作空间管理员:"layout.about.inner_wsm",普通用户:"layout.about.inner_user"},D=Q(()=>{var a,p;return s.userInfo?(p=(a=s.userInfo)==null?void 0:a.role_name)==null?void 0:p.map(K=>{const r=U[K];return r?E(r):K}):[]}),c=()=>{m.logout().then(()=>{var a;(a=s==null?void 0:s.userInfo)!=null&&a.source&&["CAS","OIDC","OAuth2"].includes(s.userInfo.source)?d.push({name:"login",query:{login_mode:"manual"}}):d.push({name:"login"})})};return he(()=>{var a,p;(a=s.userInfo)!=null&&a.is_edit_password&&((p=h.value)==null||p.open())}),(a,p)=>{var V;const K=i("el-avatar"),r=i("CaretBottom"),k=i("el-icon"),O=i("TagGroup"),A=i("el-dropdown-item"),w=i("ArrowRight"),M=i("Check"),S=i("el-dropdown-menu"),z=i("el-dropdown");return u(),W(q,null,[t(z,{trigger:"click",type:"primary"},{dropdown:o(()=>[t(S,{class:"avatar-dropdown"},{default:o(()=>{var N,G;return[n("div",tt,[n("div",ot,[t(K,{size:30},{default:o(()=>[...p[3]||(p[3]=[n("img",{src:re,style:{width:"54%"},alt:""},null,-1)])]),_:1})]),n("div",nt,[n("p",st,l((N=e(s).userInfo)==null?void 0:N.username),1),(G=e(s).userInfo)!=null&&G.role_name&&e(s).userInfo.role_name.length>0?(u(),W(q,{key:0},[e(B)([e(H).IS_EE,e(H).IS_PE],"OR")?(u(),v(O,{key:0,size:"small",tags:D.value},null,8,["tags"])):$("",!0)],64)):$("",!0)])]),e(B)([e(b).EXTENDS_ADMIN,e(b).EXTENDS_WORKSPACE_MANAGE,e(b).ADMIN,e(b).WORKSPACE_MANAGE],"OR")?(u(),v(A,{key:0,class:"border-t",onClick:p[0]||(p[0]=_=>e(d).push({path:"/system/user"}))},{default:o(()=>[n("div",at,l(a.$t("views.system.title")),1)]),_:1})):$("",!0),e(B)(new(e(Z))([e(b).ADMIN,e(b).WORKSPACE_MANAGE,e(b).USER],[e(X).CHANGE_PASSWORD],[],"OR"),"OR")?(u(),v(A,{key:1,onClick:T},{default:o(()=>[C(l(a.$t("views.login.resetPassword")),1)]),_:1})):$("",!0),n("div",null,[e(B)(new(e(Z))([e(b).ADMIN],[e(X).SYSTEM_API_KEY_EDIT],[e(H).IS_EE,e(H).IS_PE],"OR"),"OR")?(u(),v(A,{key:0,class:"p-8",onClick:x},{default:o(()=>[C(l(a.$t("layout.apiKey")),1)]),_:1})):$("",!0)]),e(B)(new(e(Z))([e(b).ADMIN,e(b).WORKSPACE_MANAGE,e(b).USER],[e(X).SWITCH_LANGUAGE],[],"OR"),"OR")?(u(),v(A,{key:2,style:{padding:"0"},onClick:p[1]||(p[1]=ee(()=>{},["stop"]))},{default:o(()=>[t(z,{class:"w-full",trigger:"hover",placement:"left-start"},{dropdown:o(()=>[t(S,{style:{width:"180px"}},{default:o(()=>[(u(!0),W(q,null,ke(e(Ae),(_,L)=>(u(),v(A,{key:L,value:_.value,onClick:J=>f(_.value),class:"flex-between"},{default:o(()=>{var J,ne,se;return[n("span",{class:Y(_.value===((J=e(s).userInfo)==null?void 0:J.language)?"primary":"")},l(_.label),3),_.value===((ne=e(s).userInfo)==null?void 0:ne.language)?(u(),v(k,{key:0,class:Y(_.value===((se=e(s).userInfo)==null?void 0:se.language)?"primary":"")},{default:o(()=>[t(M)]),_:1},8,["class"])):$("",!0)]}),_:2},1032,["value","onClick"]))),128))]),_:1})]),default:o(()=>[n("div",lt,[n("span",null,l(a.$t("layout.language")),1),t(k,null,{default:o(()=>[t(w)]),_:1})])]),_:1})]),_:1})):$("",!0),e(B)([e(b).ADMIN,e(X).ABOUT_READ],"OR")?(u(),v(A,{key:3,onClick:I},{default:o(()=>[C(l(a.$t("layout.about.title")),1)]),_:1})):$("",!0),t(A,{class:"border-t",onClick:c},{default:o(()=>[C(l(a.$t("layout.logout")),1)]),_:1})]}),_:1})]),default:o(()=>{var N;return[n("div",Qe,[t(K,{size:30},{default:o(()=>[...p[2]||(p[2]=[n("img",{src:re,style:{width:"54%"},alt:""},null,-1)])]),_:1}),n("span",et,l((N=e(s).userInfo)==null?void 0:N.username),1),t(k,{class:"el-icon--right"},{default:o(()=>[t(r)]),_:1})])]}),_:1}),t(Ze,{"user-id":(V=e(s).userInfo)==null?void 0:V.id,ref_key:"APIKeyDialogRef",ref:y},null,8,["user-id"]),t(Ee,{ref_key:"resetPasswordRef",ref:h},null,512),t(je,{ref_key:"AboutDialogRef",ref:g},null,512)],64)}}}),rt=oe(it,[["__scopeId","data-v-21e1d9bb"]]),ct={class:"flex align-center"},ut=F({__name:"index",setup(P){const{theme:s}=te();function m(d){window.open(d,"_blank")}return(d,g)=>{var x,T,U;const y=i("AppIcon"),h=i("el-button"),f=i("el-tooltip"),I=pe("hasPermission");return u(),W("div",ct,[de((u(),v(h,{round:"",onClick:g[0]||(g[0]=D=>m("https://maxkb.cn/pricing.html")),class:"pricing-button mr-8"},{default:o(()=>[t(y,{iconName:"app-pricing",class:"mr-8"}),C(" "+l(d.$t("common.upgrade")),1)]),_:1})),[[I,e(H).IS_CE]]),(x=e(s).themeInfo)!=null&&x.showProject?(u(),v(f,{key:0,effect:"dark",content:d.$t("layout.github"),placement:"top"},{default:o(()=>[t(y,{iconName:"app-github",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:g[1]||(g[1]=D=>{var c;return m((c=e(s).themeInfo)==null?void 0:c.projectUrl)})})]),_:1},8,["content"])):$("",!0),(T=e(s).themeInfo)!=null&&T.showUserManual?(u(),v(f,{key:1,effect:"dark",content:d.$t("layout.wiki"),placement:"top"},{default:o(()=>[t(y,{iconName:"app-user-manual",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:g[2]||(g[2]=D=>{var c;return m((c=e(s).themeInfo)==null?void 0:c.userManualUrl)})})]),_:1},8,["content"])):$("",!0),(U=e(s).themeInfo)!=null&&U.showForum?(u(),v(f,{key:2,effect:"dark",content:d.$t("layout.forum"),placement:"top"},{default:o(()=>[t(y,{iconName:"app-help",class:"cursor color-secondary mr-8 ml-8",style:{"font-size":"20px"},onClick:g[3]||(g[3]=D=>{var c;return m((c=e(s).themeInfo)==null?void 0:c.forumUrl)})})]),_:1},8,["content"])):$("",!0)])}}}),pt=oe(ut,[["__scopeId","data-v-3ef3b294"]]),dt={class:"app-top-bar-container border-b flex-center"},_t={class:"logo mt-4"},mt={class:"flex-between w-full align-center"},ft={class:"flex align-center mr-8"},yt=F({__name:"SystemHeader",setup(P){const s=me();return(m,d)=>{const g=i("LogoFull"),y=i("el-divider"),h=i("AppIcon"),f=i("el-button");return u(),W("div",dt,[n("div",_t,[t(g)]),n("div",mt,[n("h4",null,[t(y,{class:"ml-16 mr-16",direction:"vertical"}),C(l(m.$t("views.system.title")),1)]),n("div",ft,[t(pt),t(y,{class:"ml-8 mr-8",direction:"vertical"}),e(B)([e(b).USER.getWorkspaceRole,e(b).EXTENDS_USER.getWorkspaceRole,e(b).EXTENDS_WORKSPACE_MANAGE.getWorkspaceRole,e(b).WORKSPACE_MANAGE.getWorkspaceRole],"OR")?(u(),v(f,{key:0,link:"",onClick:d[0]||(d[0]=I=>e(s).push({path:"/"})),style:{color:"var(--el-text-color-primary)"}},{default:o(()=>[t(h,{class:"mr-8",iconName:"app-workspace",style:{"font-size":"16px"}}),C(" "+l(m.$t("views.workspace.toWorkspace")),1)]),_:1})):$("",!0)])]),t(rt)])}}}),ht=oe(yt,[["__scopeId","data-v-c20e3067"]]),kt=F({__name:"index",setup(P){const s=_e(),m=R([]);return we(()=>{const{name:d,meta:g}=s;d&&!m.value.includes(d)&&m.value.push(d)}),(d,g)=>{const y=i("router-view");return u(),v(y,null,{default:o(({Component:h})=>[t($e,{appear:"",name:"fade-transform",mode:"out-in"},{default:o(()=>[(u(),v(Ie,{include:m.value},[(u(),v(Ce(h),{key:e(s).path}))],1032,["include"]))]),_:2},1024)]),_:1})}}});export{rt as A,ht as S,pt as T,kt as _};
