import{_ as g}from"./logo_dingtalk-CyDPr22R.js";import{ay as u,az as m,aA as f,cc as _,aB as h,aV as k,aW as y,aF as w,aI as a,aJ as C,aX as v,c1 as q}from"./admin-Ca7cl6NN.js";const B={class:"flex-center mb-16"},x=u({__name:"dingtalkQrCode",props:{config:{}},setup(r){const o=r,s=m(),{login:c}=f(),{load:d}=_("https://g.alicdn.com/dingding/h5-dingtalk-login/0.21.0/ddlogin.js"),n=h(!1),p=async()=>{try{if(await d(!0),!n.value)return;const e={appKey:o.config.app_key,appSecret:o.config.app_secret,corp_id:o.config.corp_id},t=encodeURIComponent(window.location.origin);window.DTFrameLogin({id:"ding-talk-qr",width:280,height:280},{redirect_uri:t,client_id:e.appKey,scope:"openid corpid",response_type:"code",state:"fit2cloud-ding-qr",prompt:"consent",corpId:e.corp_id},i=>{const l=i.authCode;c.dingCallback(l).then(()=>{s.push({name:"home"})})},i=>{q(i)})}catch{}};return k(()=>o.config,e=>{e.app_key&&e.corp_id&&(n.value=!0,p())},{immediate:!0}),(e,t)=>(w(),y(v,null,[a("div",B,[t[0]||(t[0]=a("img",{src:g,alt:"",width:"24px",class:"mr-4"},null,-1)),a("h2",null,C(e.$t("views.system.authentication.scanTheQRCode.dingtalkQrCode")),1)]),t[1]||(t[1]=a("div",{class:"ding-talk-qrName"},[a("div",{id:"ding-talk-qr"})],-1))],64))}});export{x as default};
