import{ay as ne,aA as be,aB as s,aO as Z,aP as fe,b4 as Ue,aV as oe,aE as A,aG as e,aD as a,aI as u,aH as l,aW as X,aJ as c,aK as C,b2 as ke,ci as xe,b1 as G,cw as Pe,b8 as ce,cg as Ce,cA as Ae,aF as k,bD as we,cl as Ie,b$ as Le,aU as Se,c0 as qe,aC as Y,cf as Me,bY as ze,aZ as Fe,b7 as $e,ce as ve,aS as ee,aT as de,dE as Ne,aY as Ve,aX as he,aR as De,c1 as Te,bX as Re,dy as Ee}from"./admin-Ca7cl6NN.js";const Ke={class:"generate-prompt-dialog-bg border-r-8"},He={class:"scrollbar-height"},Oe={class:"p-16 pb-0 lighter"},Be={key:1,shadow:"always",style:{margin:"0.5rem 0"}},We={key:2,class:"flex align-center"},je={key:0,class:"mt-8"},Ge={key:1,class:"mt-8"},Je={class:"generate-prompt-operate p-16"},Xe={key:0,class:"text-center mb-8"},Ye={class:"operate-textarea"},Qe={class:"operate"},Ze={class:"text-right"},el={src:Ae,alt:""},ll=ne({__name:"GeneratePromptDialog",emits:["replace"],setup(Q,{expose:K,emit:H}){const E=H,{user:M}=be(),v=fe(),T=s([]),R=Z(()=>v.path.includes("resource-management")?"systemManage":"workspace"),i=s(""),h=s(""),p=s(""),y=s(!1),r=s(""),n=s(!1),z={INIT_TEMPLATE:`
è¯·æ ¹æ®ç”¨æˆ·æè¿°ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„AIè§’è‰²äººè®¾æ¨¡æ¿:

åº”ç”¨åç§°ï¼š{application_name}
åº”ç”¨æè¿°ï¼š{detail}
ç”¨æˆ·éœ€æ±‚ï¼š{userInput}

é‡è¦è¯´æ˜ï¼š
1. è§’è‰²è®¾å®šå¿…é¡»æœåŠ¡äº"{application_name}"åº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½
2. å…è®¸ç”¨æˆ·å¯¹è§’è‰²è®¾å®šçš„å…·ä½“å†…å®¹è¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–
3. å¦‚æœç”¨æˆ·è¦æ±‚ä¿®æ”¹æŸä¸ªæŠ€èƒ½æˆ–éƒ¨åˆ†ï¼Œåœ¨ä¿æŒåº”ç”¨ä¸»é¢˜çš„å‰æä¸‹è¿›è¡Œç›¸åº”è°ƒæ•´

è¯·æŒ‰ä»¥ä¸‹æ ¼å¼ç”Ÿæˆï¼š

å¿…é¡»ä¸¥æ ¼éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š
1. **ä¸¥æ ¼ç¦æ­¢è¾“å‡ºè§£é‡Šã€å‰è¨€ã€é¢å¤–è¯´æ˜**ï¼Œåªè¾“å‡ºæœ€ç»ˆç»“æœã€‚
2. **ä¸¥æ ¼ä½¿ç”¨ä»¥ä¸‹æ ¼å¼**ï¼Œä¸èƒ½ç¼ºå°‘æ ‡é¢˜ã€ä¸èƒ½å¤šå‡ºå…¶ä»–æ®µè½ã€‚
3. **å¦‚æœç”¨æˆ·è¦æ±‚ä¿®æ”¹è§’è‰²è®¾å®šçš„æŸä¸ªéƒ¨åˆ†ï¼Œåœ¨ä¿æŒåº”ç”¨æ ¸å¿ƒåŠŸèƒ½çš„å‰æä¸‹è¿›è¡Œè°ƒæ•´**ã€‚
4. **å¦‚æœç”¨æˆ·éœ€æ±‚ä¸è§’è‰²è®¾å®šç”Ÿæˆå®Œå…¨æ— å…³ï¼ˆå¦‚é—²èŠã€å…¶ä»–è¯é¢˜ï¼‰ï¼Œåˆ™ä¸»è¦ä¾æ®åº”ç”¨ä¿¡æ¯ç”Ÿæˆæ ‡å‡†è§’è‰²è®¾å®šï¼Œä½†ä¸å®Œå…¨å¿½ç•¥ç”¨æˆ·è¾“å…¥ï¼Œå¯ä»ä¸­æå–æœ‰ä»·å€¼çš„è¾…åŠ©ä¿¡æ¯ï¼ˆå¦‚é¢†åŸŸèƒŒæ™¯ã€è¯­æ°”é£æ ¼ç­‰ï¼‰ä½œä¸ºæ¬¡è¦å‚è€ƒ**ã€‚

# è§’è‰²:
è§’è‰²æ¦‚è¿°å’Œä¸»è¦èŒè´£çš„ä¸€å¥è¯æè¿°

## ç›®æ ‡ï¼š
è§’è‰²çš„å·¥ä½œç›®æ ‡,å¦‚æœæœ‰å¤šç›®æ ‡å¯ä»¥åˆ†ç‚¹åˆ—å‡º,ä½†å»ºè®®æ›´èšç„¦1-2ä¸ªç›®æ ‡

## æ ¸å¿ƒæŠ€èƒ½ï¼š
### æŠ€èƒ½ 1: [æŠ€èƒ½åç§°ï¼Œå¦‚ä½œå“æ¨è/ä¿¡æ¯æŸ¥è¯¢/ä¸“ä¸šåˆ†æç­‰]
1. [æ‰§è¡Œæ­¥éª¤1 - æè¿°è¯¥æŠ€èƒ½çš„ç¬¬ä¸€ä¸ªå…·ä½“æ“ä½œæ­¥éª¤ï¼ŒåŒ…æ‹¬æ¡ä»¶åˆ¤æ–­å’Œå¤„ç†æ–¹å¼]
2. [æ‰§è¡Œæ­¥éª¤2 - æè¿°è¯¥æŠ€èƒ½çš„ç¬¬äºŒä¸ªå…·ä½“æ“ä½œæ­¥éª¤ï¼ŒåŒ…æ‹¬å¦‚ä½•è·å–æˆ–å¤„ç†ä¿¡æ¯]
3. [æ‰§è¡Œæ­¥éª¤3 - æè¿°è¯¥æŠ€èƒ½çš„æœ€ç»ˆè¾“å‡ºæ­¥éª¤ï¼Œè¯´æ˜å¦‚ä½•å‘ˆç°ç»“æœ]

===å›å¤ç¤ºä¾‹===
- ğŸ“‹ [æ ‡è¯†ç¬¦]: <å…·ä½“å†…å®¹æ ¼å¼è¯´æ˜>
- ğŸ¯ [æ ‡è¯†ç¬¦]: <å…·ä½“å†…å®¹æ ¼å¼è¯´æ˜>
- ğŸ’¡ [æ ‡è¯†ç¬¦]: <å…·ä½“å†…å®¹æ ¼å¼è¯´æ˜>
===ç¤ºä¾‹ç»“æŸ===

### æŠ€èƒ½ 2: [æŠ€èƒ½åç§°]
1. [æ‰§è¡Œæ­¥éª¤1 - æè¿°è§¦å‘æ¡ä»¶å’Œåˆå§‹å¤„ç†æ–¹å¼]
2. [æ‰§è¡Œæ­¥éª¤2 - æè¿°ä¿¡æ¯è·å–å’Œæ·±åŒ–å¤„ç†çš„å…·ä½“æ–¹æ³•]
3. [æ‰§è¡Œæ­¥éª¤3 - æè¿°æœ€ç»ˆè¾“å‡ºçš„å…·ä½“è¦æ±‚å’Œæ ¼å¼]

### æŠ€èƒ½ 3: [æŠ€èƒ½åç§°]
- [æ ¸å¿ƒèƒ½åŠ›æè¿° - è¯´æ˜è¯¥æŠ€èƒ½çš„ä¸»è¦ä½œç”¨å’ŒçŸ¥è¯†åŸºç¡€]
- [åº”ç”¨æ–¹æ³• - æè¿°å¦‚ä½•è¿ç”¨è¯¥æŠ€èƒ½ä¸ºç”¨æˆ·æä¾›æœåŠ¡ï¼ŒåŒ…æ‹¬å…·ä½“çš„å®æ–½æ–¹å¼]

## å·¥ä½œæµï¼š
1. æè¿°è§’è‰²å·¥ä½œæµç¨‹çš„ç¬¬ä¸€æ­¥
2. æè¿°è§’è‰²å·¥ä½œæµç¨‹çš„ç¬¬äºŒæ­¥
3. æè¿°è§’è‰²å·¥ä½œæµç¨‹çš„ç¬¬ä¸‰æ­¥

## è¾“å‡ºæ ¼å¼ï¼š
å¦‚æœå¯¹è§’è‰²çš„è¾“å‡ºæ ¼å¼æœ‰ç‰¹å®šè¦æ±‚ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¼ºè°ƒå¹¶ä¸¾ä¾‹è¯´æ˜æƒ³è¦çš„è¾“å‡ºæ ¼å¼


## é™åˆ¶ï¼š
1. **ä¸¥æ ¼é™åˆ¶å›ç­”èŒƒå›´**ï¼šä»…å›ç­”ä¸è§’è‰²è®¾å®šç›¸å…³çš„é—®é¢˜ã€‚
   - å¦‚æœç”¨æˆ·æé—®ä¸è§’è‰²æ— å…³ï¼Œå¿…é¡»ä½¿ç”¨ä»¥ä¸‹å›ºå®šæ ¼å¼å›å¤ï¼š
     â€œå¯¹ä¸èµ·ï¼Œæˆ‘åªèƒ½å›ç­”ä¸[è§’è‰²è®¾å®š]ç›¸å…³çš„é—®é¢˜ï¼Œæ‚¨çš„é—®é¢˜ä¸åœ¨æœåŠ¡èŒƒå›´å†…ã€‚â€
   - ä¸å¾—æä¾›ä»»ä½•ä¸è§’è‰²è®¾å®šæ— å…³çš„å›ç­”ã€‚
2. æè¿°è§’è‰²åœ¨äº’åŠ¨è¿‡ç¨‹ä¸­éœ€è¦éµå¾ªçš„é™åˆ¶æ¡ä»¶2
3. æè¿°è§’è‰²åœ¨äº’åŠ¨è¿‡ç¨‹ä¸­éœ€è¦éµå¾ªçš„é™åˆ¶æ¡ä»¶3

è¾“å‡ºæ—¶ä¸å¾—åŒ…å«ä»»ä½•è§£é‡Šæˆ–é™„åŠ è¯´æ˜ï¼Œåªèƒ½è¿”å›ç¬¦åˆä»¥ä¸Šæ ¼å¼çš„å†…å®¹ã€‚
  `},q=s(!1),U=s(!1),t=s(""),o=s(0);let m=null;const f=s(!1),x=()=>{m&&clearInterval(m),q.value=!0,U.value=!1,m=setInterval(()=>{if(O.value&&!U.value){const d=T.value[T.value.length-1];d&&d.role==="ai"&&(d.content=t.value),S();return}if(!U.value&&o.value<t.value.length){const d=Math.min(3,t.value.length-o.value);o.value+=d;const w=T.value[T.value.length-1];w&&w.role==="ai"&&(w.content=t.value.substring(0,o.value))}else n.value===!1&&o.value>=t.value.length&&S()},50)},S=()=>{m&&(clearInterval(m),m=null),q.value=!1,U.value=!1,n.value=!1,f.value=!0},$=Z(()=>q.value),g=()=>{U.value=!0,q.value=!1},D=()=>{o.value<t.value.length&&x()},b=d=>{let w="";const P=Se({content:"",role:"ai"});T.value.push(P),t.value="",o.value=0,f.value=!1;let F=!1;const N=({done:_e,value:J})=>{try{if(_e){n.value=!1,O.value=!0;return}let re=new TextDecoder("utf-8").decode(J,{stream:!0});w+=re;const ue=w.match(/data:.*}\n\n/g);if(ue)re=ue.join(""),w=w.replace(re,"");else return d.read().then(N);if(re&&re.startsWith("data:")&&ue)for(const ye in ue){const B=JSON==null?void 0:JSON.parse(ue[ye].replace("data:",""));if(B.error)return n.value=!1,S(),P.content=B.error,Promise.reject(new Error(B.error));if(B.is_end||(t.value+=B.content,F||(F=!0,x())),B.is_end)return Promise.resolve()}}catch(ge){return n.value=!1,S(),Promise.reject(ge)}return d.read().then(N)};return N},O=s(!1),_=Z(()=>{const d=T.value[T.value.length-1];return d&&d.role=="ai"?d.content:""}),V=Z(()=>!q.value&&U.value&&o.value<t.value.length);function L(d){O.value=!1,n.value=!0;const w=M.getWorkspaceId()||"default";T.value.push({content:d,role:"user"});const P={messages:T.value,prompt:z.INIT_TEMPLATE};R.value==="workspace"?Ie.generate_prompt(w,h.value,p.value,P).then(F=>{we(()=>{I.value&&W.value.setScrollTop(ie())});const N=F.body.getReader();N.read().then(b(N))}):R.value==="systemManage"&&Le.generate_prompt(p.value,h.value,P).then(F=>{we(()=>{I.value&&W.value.setScrollTop(ie())});const N=F.body.getReader();N.read().then(b(N))})}const le=()=>{i.value&&L(`ä¸Šä¸€æ¬¡å›ç­”ä¸æ»¡æ„ã€‚è¯·é’ˆå¯¹åŸå§‹é—®é¢˜"${i.value}"å¹¶ç»“åˆå¯¹è¯è®°å½•ï¼Œä¸¥æ ¼æŒ‰ç…§æ ¼å¼è§„èŒƒé‡æ–°ç”Ÿæˆã€‚`)},ae=s(),j=d=>{if(!(d!=null&&d.ctrlKey)&&!(d!=null&&d.shiftKey)&&!(d!=null&&d.altKey)&&!(d!=null&&d.metaKey)){if(d==null||d.preventDefault(),!r.value.trim()||n.value||q.value||(i.value||(i.value=r.value),U.value||q.value))return;r.value&&(L(r.value),r.value="")}else te(d)},te=d=>{const w=ae.value.$el.querySelector(".el-textarea__inner"),P=w.selectionStart,F=w.selectionEnd;d.preventDefault(),r.value=r.value.slice(0,P)+`
`+r.value.slice(F),we(()=>{w.setSelectionRange(P+1,P+1)})},se=(d,w)=>{h.value=d,p.value=w,y.value=!0,i.value="",T.value=[]},W=s(),I=s(),ie=()=>I.value.scrollHeight,pe=()=>{var d;W.value&&W.value.wrapRef.offsetHeight<((d=I.value)==null?void 0:d.scrollHeight)&&W.value.setScrollTop(ie())},me=d=>{_.value?qe(Y("common.tip"),Y("views.application.generateDialog.exit"),{confirmButtonText:Y("common.confirm"),cancelButtonText:Y("common.cancel"),distinguishCancelAndClose:!0}).then(()=>{S(),T.value=[],t.value="",o.value=0,f.value=!1,d()}).catch(()=>{}):d()};return Ue(()=>{S()}),oe(_,()=>{pe()},{deep:!0,immediate:!0}),K({open:se}),(d,w)=>{const P=a("Loading"),F=a("el-icon"),N=a("AppIcon"),_e=a("el-scrollbar"),J=a("el-button"),ge=a("app-icon"),re=a("el-input"),ue=a("SendIcon"),ye=a("el-dialog");return k(),A(ye,{"align-center":"",title:d.$t("views.application.generateDialog.generatePrompt"),modelValue:y.value,"onUpdate:modelValue":w[4]||(w[4]=B=>y.value=B),style:{width:"600px"},"append-to-body":"","close-on-click-modal":!0,"close-on-press-escape":!0,"before-close":me},{default:e(()=>[u("div",Ke,[u("div",He,[u("div",Oe,[l(_e,{ref_key:"scrollDiv",ref:W},{default:e(()=>[_.value?(k(),X("div",{key:0,ref_key:"dialogScrollbar",ref:I,class:"pre-wrap lighter",style:{"max-height":"calc(100vh - 400px)"}},c(_.value),513)):n.value?(k(),X("p",Be,[l(F,{class:"is-loading color-primary mr-4"},{default:e(()=>[l(P)]),_:1}),C(" "+c(d.$t("views.application.generateDialog.loading"))+" ",1),w[5]||(w[5]=u("span",{class:"dotting"},null,-1))])):(k(),X("p",We,[l(N,{iconName:"app-generate-star",class:"color-primary mr-4"}),C(" "+c(d.$t("views.application.generateDialog.title")),1)]))]),_:1},512),_.value&&!n.value&&!q.value&&!V.value?(k(),X("div",je,[l(J,{type:"primary",onClick:w[0]||(w[0]=()=>E("replace",_.value))},{default:e(()=>[C(c(d.$t("views.application.generateDialog.replace")),1)]),_:1}),l(J,{onClick:w[1]||(w[1]=B=>ke(xe)(_.value))},{default:e(()=>[C(c(d.$t("common.copy")),1)]),_:1}),l(J,{onClick:le,disabled:!_.value||n.value,loading:n.value},{default:e(()=>[C(c(d.$t("views.application.generateDialog.remake")),1)]),_:1},8,["disabled","loading"])])):(k(),X("div",Ge,[V.value?(k(),A(J,{key:0,type:"primary",onClick:D,link:""},{default:e(()=>[C(c(d.$t("views.application.generateDialog.continue")),1)]),_:1})):G("",!0)]))]),u("div",Je,[$.value?(k(),X("div",Xe,[l(J,{class:"border-primary video-stop-button",onClick:g},{default:e(()=>[l(ge,{iconName:"app-video-stop",class:"mr-8"}),C(" "+c(d.$t("views.application.generateDialog.stop")),1)]),_:1})])):G("",!0),u("div",Ye,[l(re,{ref_key:"quickInputRef",ref:ae,modelValue:r.value,"onUpdate:modelValue":w[2]||(w[2]=B=>r.value=B),autosize:{minRows:1,maxRows:10},type:"textarea",placeholder:d.$t("views.application.generateDialog.placeholder"),maxlength:1e5,class:"chat-operate-textarea",onKeydown:w[3]||(w[3]=Pe(B=>j(B),["enter"]))},null,8,["modelValue","placeholder"]),u("div",Qe,[u("div",Ze,[l(J,{text:"",class:"sent-button",disabled:!r.value.trim()||n.value||q.value,onClick:j},{default:e(()=>[ce(u("img",el,null,512),[[Ce,!r.value.trim()||n.value||q.value]]),ce(l(ue,null,null,512),[[Ce,r.value.trim()&&!n.value&&!q.value]])]),_:1},8,["disabled"])])])])])])])]),_:1},8,["title","modelValue"])}}}),Kl=Me(ll,[["__scopeId","data-v-706a236c"]]),al={class:"p-8"},tl={class:"mb-4"},ol={class:"mb-4"},nl={class:"mb-4"},sl={class:"flex align-center"},il={class:"mr-4"},rl={class:"flex align-center"},ul={class:"mr-4"},dl={class:"dialog-footer"},Hl=ne({__name:"ParamSettingDialog",emits:["refresh"],setup(Q,{expose:K,emit:H}){const E=H,M=s(),v=s(),T={ai_questioning:"{question}",designated_answer:Y("views.application.dialog.designated_answer")},R=Y("views.application.dialog.defaultPrompt1",{question:"{question}"})+"<data></data>"+Y("views.application.dialog.defaultPrompt2"),i=s({knowledge_setting:{search_mode:"embedding",top_n:3,similarity:.6,max_paragraph_char_number:5e3,no_references_setting:{status:"ai_questioning",value:"{question}"}},problem_optimization:!1,problem_optimization_prompt:R}),h=s({ai_questioning:T.ai_questioning,designated_answer:T.designated_answer}),p=Se({ai_questioning:[{required:!0,message:Y("views.application.form.aiModel.placeholder"),trigger:"blur"}],designated_answer:[{required:!0,message:Y("common.prompt.placeholder"),trigger:"blur"}]}),y=s(!1),r=s(!1),n=s(!1);oe(y,t=>{var o;t||(h.value={ai_questioning:T.ai_questioning,designated_answer:T.designated_answer},(o=v.value)==null||o.clearValidate())});const z=(t,o)=>{n.value=ze(o),i.value={knowledge_setting:Fe.cloneDeep(t.knowledge_setting),problem_optimization:t.problem_optimization,problem_optimization_prompt:t.problem_optimization_prompt},n.value||(h.value[i.value.knowledge_setting.no_references_setting.status]=i.value.knowledge_setting.no_references_setting.value),y.value=!0},q=async t=>{if(n.value)delete i.value.no_references_setting,E("refresh",i.value),y.value=!1;else{if(!t)return;await t.validate((o,m)=>{o&&(i.value.knowledge_setting.no_references_setting.value=h.value[i.value.knowledge_setting.no_references_setting.status],E("refresh",i.value),y.value=!1)})}};function U(t){t==="keywords"?i.value.knowledge_setting.similarity=0:i.value.knowledge_setting.similarity=.6}return K({open:z}),(t,o)=>{const m=a("el-text"),f=a("el-radio"),x=a("el-card"),S=a("el-radio-group"),$=a("el-form-item"),g=a("AppIcon"),D=a("el-tooltip"),b=a("el-input-number"),O=a("el-col"),_=a("el-row"),V=a("el-slider"),L=a("el-input"),le=a("el-form"),ae=a("el-switch"),j=a("el-scrollbar"),te=a("el-button"),se=a("el-dialog"),W=$e("loading");return k(),A(se,{class:"scrollbar-dialog","align-center":"",title:t.$t("common.paramSetting"),modelValue:y.value,"onUpdate:modelValue":o[11]||(o[11]=I=>y.value=I),width:"550px","append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[u("span",dl,[l(te,{onClick:o[9]||(o[9]=ee(I=>y.value=!1,["prevent"]))},{default:e(()=>[C(c(t.$t("common.cancel")),1)]),_:1}),l(te,{type:"primary",onClick:o[10]||(o[10]=I=>q(v.value)),loading:r.value},{default:e(()=>[C(c(t.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[l(j,{"max-height":"550"},{default:e(()=>[u("div",al,[ce((k(),A(le,{"label-position":"top",ref_key:"paramFormRef",ref:M,model:i.value},{default:e(()=>[l($,{label:t.$t("views.application.dialog.selectSearchMode")},{default:e(()=>[l(S,{modelValue:i.value.knowledge_setting.search_mode,"onUpdate:modelValue":o[0]||(o[0]=I=>i.value.knowledge_setting.search_mode=I),class:"card__radio",onChange:U},{default:e(()=>[l(x,{shadow:"never",class:ve(["mb-16",i.value.search_mode==="embedding"?"active":""])},{default:e(()=>[l(f,{value:"embedding",size:"large"},{default:e(()=>[u("p",tl,c(t.$t("views.application.dialog.vectorSearch")),1),l(m,{type:"info"},{default:e(()=>[C(c(t.$t("views.application.dialog.vectorSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(x,{shadow:"never",class:ve(["mb-16",i.value.knowledge_setting.search_mode==="keywords"?"active":""])},{default:e(()=>[l(f,{value:"keywords",size:"large"},{default:e(()=>[u("p",ol,c(t.$t("views.application.dialog.fullTextSearch")),1),l(m,{type:"info"},{default:e(()=>[C(c(t.$t("views.application.dialog.fullTextSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(x,{shadow:"never",class:ve(i.value.knowledge_setting.search_mode==="blend"?"active":"")},{default:e(()=>[l(f,{value:"blend",size:"large"},{default:e(()=>[u("p",nl,c(t.$t("views.application.dialog.hybridSearch")),1),l(m,{type:"info"},{default:e(()=>[C(c(t.$t("views.application.dialog.hybridSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(_,{gutter:10},{default:e(()=>[l(O,{span:12},{default:e(()=>[l($,null,{label:e(()=>[u("div",sl,[u("span",il,c(t.$t("views.application.dialog.similarityThreshold")),1),l(D,{effect:"dark",content:t.$t("views.application.dialog.similarityTooltip"),placement:"right"},{default:e(()=>[l(g,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:e(()=>[l(b,{modelValue:i.value.knowledge_setting.similarity,"onUpdate:modelValue":o[1]||(o[1]=I=>i.value.knowledge_setting.similarity=I),min:0,max:i.value.knowledge_setting.search_mode==="blend"?2:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",class:"w-full"},null,8,["modelValue","max"])]),_:1})]),_:1}),l(O,{span:12},{default:e(()=>[l($,{label:t.$t("views.application.dialog.topReferences")},{default:e(()=>[l(b,{modelValue:i.value.knowledge_setting.top_n,"onUpdate:modelValue":o[2]||(o[2]=I=>i.value.knowledge_setting.top_n=I),min:1,max:1e4,"value-on-clear":1,"controls-position":"right",class:"w-full"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),l($,{label:t.$t("views.application.dialog.maxCharacters")},{default:e(()=>[l(V,{modelValue:i.value.knowledge_setting.max_paragraph_char_number,"onUpdate:modelValue":o[3]||(o[3]=I=>i.value.knowledge_setting.max_paragraph_char_number=I),"show-input":"","show-input-controls":!1,min:500,max:1e5,class:"custom-slider"},null,8,["modelValue"])]),_:1},8,["label"]),n.value?G("",!0):(k(),A($,{key:0,label:t.$t("views.application.dialog.noReferencesAction")},{default:e(()=>[l(le,{"label-position":"top",ref_key:"noReferencesformRef",ref:v,model:h.value,rules:p,"hide-required-asterisk":!0,class:"w-full"},{default:e(()=>[l(S,{modelValue:i.value.knowledge_setting.no_references_setting.status,"onUpdate:modelValue":o[5]||(o[5]=I=>i.value.knowledge_setting.no_references_setting.status=I),class:"radio-block-avatar"},{default:e(()=>[l(f,{value:"ai_questioning"},{default:e(()=>[u("p",null,c(t.$t("views.application.dialog.continueQuestioning")),1)]),_:1}),l(f,{value:"designated_answer"},{default:e(()=>[u("p",null,c(t.$t("views.application.dialog.provideAnswer")),1),i.value.knowledge_setting.no_references_setting.status==="designated_answer"?(k(),A($,{key:0,prop:"designated_answer"},{default:e(()=>[l(L,{modelValue:h.value.designated_answer,"onUpdate:modelValue":o[4]||(o[4]=I=>h.value.designated_answer=I),rows:2,type:"textarea",maxlength:"2048",placeholder:T.designated_answer},null,8,["modelValue","placeholder"])]),_:1})):G("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])]),_:1},8,["label"])),n.value?G("",!0):(k(),A($,{key:1,onClick:o[7]||(o[7]=ee(()=>{},["prevent"]))},{label:e(()=>[u("div",rl,[u("span",ul,c(t.$t("views.application.form.problemOptimization.label")),1)])]),default:e(()=>[l(ae,{size:"small",modelValue:i.value.problem_optimization,"onUpdate:modelValue":o[6]||(o[6]=I=>i.value.problem_optimization=I)},null,8,["modelValue"])]),_:1})),i.value.problem_optimization?(k(),A($,{key:2,label:t.$t("common.prompt.label")},{default:e(()=>[l(L,{modelValue:i.value.problem_optimization_prompt,"onUpdate:modelValue":o[8]||(o[8]=I=>i.value.problem_optimization_prompt=I),rows:6,type:"textarea",maxlength:"2048",placeholder:R},null,8,["modelValue"])]),_:1},8,["label"])):G("",!0)]),_:1},8,["model"])),[[W,r.value]])])]),_:1})]),_:1},8,["title","modelValue"])}}}),cl={class:"flex-between mb-8"},pl={class:"flex"},ml=["id"],_l={class:"p-8"},vl={class:"layout-bg"},fl={class:"flex-between p-16 ml-8"},gl={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},hl=["title"],yl={class:"flex-between"},wl={class:"flex"},Ol=ne({__name:"AddKnowledgeDialog",props:{data:{type:Array,default:()=>[]},loading:Boolean},emits:["addData"],setup(Q,{expose:K,emit:H}){const E=fe(),M=Q,v=H,{folder:T,user:R}=be(),i=Z(()=>E.path.includes("shared")?"systemShare":E.path.includes("resource-management")?"systemManage":"workspace"),h=s(!1),p=s([]),y=s(""),r=s(""),n=s([]),z=s([]),q=s(!1),U=Z(()=>y.value?n.value.filter(_=>_.embedding_model_id===y.value):n.value);oe(h,_=>{_||(p.value=[],y.value="",r.value="",n.value=[],z.value=[])}),oe(r,_=>{_?n.value=z.value.filter(V=>{var L;return V.name.includes(_)&&V.folder_id===((L=$.value)==null?void 0:L.id)}):n.value=z.value.filter(V=>{var L;return V.folder_id===((L=$.value)==null?void 0:L.id)})});function t(){var _,V;p.value.length>0?y.value=(V=(_=z.value)==null?void 0:_.find(L=>L.id===p.value[0]))==null?void 0:V.embedding_model_id:p.value.length===0&&(y.value="")}function o(){p.value=[],y.value=""}const m=_=>{p.value=_,b(),p.value.length>0&&(y.value=M.data.filter(V=>V.id===p.value[0])[0].embedding_model_id),h.value=!0},f=()=>{v("addData",z.value.filter(_=>p.value.includes(_.id))),h.value=!1},x=()=>{r.value="",z.value=[],O()},S=s([]),$=s({}),g=s(!1);function D(_){var V;_.id!==((V=$.value)==null?void 0:V.id)&&($.value=_,O())}function b(){const _={};T.asyncGetFolder("KNOWLEDGE",_,g).then(V=>{var L;S.value=V.data,$.value=((L=V.data)==null?void 0:L[0])||{},O()})}function O(){var V;const _=((V=$.value)==null?void 0:V.id)||R.getWorkspaceId();de({type:"knowledge",isShared:_==="share",systemType:i.value}).getKnowledgeList({folder_id:_},q).then(L=>{z.value=Ne([...z.value,...L.data],"id"),n.value=L.data})}return K({open:m}),(_,V)=>{const L=a("el-text"),le=a("Refresh"),ae=a("el-icon"),j=a("el-button"),te=a("folder-tree"),se=a("el-input"),W=a("CardCheckbox"),I=a("el-col"),ie=a("el-row"),pe=a("el-empty"),me=a("el-scrollbar"),d=a("LayoutContainer"),w=a("el-dialog"),P=$e("loading");return k(),A(w,{title:_.$t("views.application.dialog.addKnowledge"),modelValue:h.value,"onUpdate:modelValue":V[3]||(V[3]=F=>h.value=F),width:"1000","append-to-body":"",class:"addKnowledge-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:F,titleClass:N})=>[u("div",cl,[u("div",pl,[u("h4",{id:F,class:ve([N,"mr-8"])},c(_.$t("views.application.dialog.addKnowledge")),11,ml),l(L,{type:"info"},{default:e(()=>[C(c(_.$t("views.application.dialog.addKnowledgePlaceholder")),1)]),_:1})]),l(j,{link:"",class:"mr-24",onClick:x},{default:e(()=>[l(ae,{size:18},{default:e(()=>[l(le)]),_:1})]),_:1})])]),footer:e(()=>[u("div",yl,[u("div",wl,[p.value.length>0?(k(),A(L,{key:0,class:"color-secondary mr-8"},{default:e(()=>[C(c(_.$t("common.selected"))+" "+c(p.value.length),1)]),_:1})):G("",!0),p.value.length>0?(k(),A(j,{key:1,link:"",type:"primary",onClick:o},{default:e(()=>[C(c(_.$t("common.clear")),1)]),_:1})):G("",!0)]),u("span",null,[l(j,{onClick:V[2]||(V[2]=ee(F=>h.value=!1,["prevent"]))},{default:e(()=>[C(c(_.$t("common.cancel")),1)]),_:1}),l(j,{type:"primary",onClick:f},{default:e(()=>[C(c(_.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(d,{class:"application-manage"},{left:e(()=>{var F;return[u("div",_l,[ce(l(te,{data:S.value,currentNodeKey:(F=$.value)==null?void 0:F.id,onHandleNodeClick:D,canOperation:!1,showShared:"",shareTitle:_.$t("views.shared.shared_knowledge"),treeStyle:{height:"calc(100vh - 240px)"}},null,8,["data","currentNodeKey","shareTitle"]),[[P,g.value]])])]}),default:e(()=>{var F;return[u("div",vl,[u("div",fl,[u("h4",null,c((F=$.value)==null?void 0:F.name),1),l(se,{modelValue:r.value,"onUpdate:modelValue":V[0]||(V[0]=N=>r.value=N),placeholder:_.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(me,null,{default:e(()=>[u("div",gl,[U.value.length?ce((k(),A(ie,{key:0,gutter:12},{default:e(()=>[(k(!0),X(he,null,Ve(U.value.filter(N=>N.resource_type!=="folder"),(N,_e)=>(k(),A(I,{span:12,key:_e,class:"mb-16"},{default:e(()=>[l(W,{"value-field":"id",data:N,modelValue:p.value,"onUpdate:modelValue":V[1]||(V[1]=J=>p.value=J),onChange:t},{default:e(()=>[u("span",{class:"ellipsis cursor ml-12",title:N.name},c(N.name),9,hl)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[P,Q.loading||q.value]]):(k(),A(pe,{key:1,description:_.$t("common.noData")},null,8,["description"]))])]),_:1})])]}),_:1})]),_:1},8,["title","modelValue"])}}}),bl={class:"flex-between"},kl={class:"dialog-footer"},Bl=ne({__name:"TTSModeParamSettingDialog",emits:["refresh"],setup(Q,{expose:K,emit:H}){const E=fe(),{params:{id:M}}=E,v=Z(()=>E.path.includes("resource-management")?"systemManage":"workspace"),T=s(""),R=s([]),i=H,h=s(),p=s({}),y=s(!1),r=s(!1),n=s(!1),z=(m,f,x)=>{p.value={},T.value=m,de({type:"model",systemType:v.value}).getModelParamsForm(m,r).then(S=>{var g;R.value=S.data;const $=S.data.map(D=>({[D.field]:D.show_default_value!==!1?D.default_value:void 0})).reduce((D,b)=>({...D,...b}),{});x&&Object.keys(x).forEach(D=>{D in $||delete x[D]}),x={...$,...x},(g=h.value)==null||g.render(R.value,x)}),y.value=!0},q=(m,f)=>{de({type:"model",systemType:v.value}).getModelParamsForm(m,r).then(x=>{R.value=x.data;const S=x.data.map($=>({[$.field]:$.show_default_value!==!1?$.default_value:void 0})).reduce(($,g)=>({...$,...g}),{});i("refresh",S)})},U=async()=>{var m;(m=h.value)==null||m.validate().then(()=>{i("refresh",p.value),y.value=!1})},t=s(null),o=()=>{const m={...p.value,tts_model_id:T.value};de({type:"application",systemType:v.value}).playDemoText(M,m,n).then(async f=>{if(f.type==="application/json"){const $=await f.text();Te($);return}const x=new Blob([f],{type:"audio/mp3"}),S=URL.createObjectURL(x);t.value instanceof HTMLAudioElement?(t.value.src=S,t.value.play()):console.error("audioPlayer.value is not an instance of HTMLAudioElement")}).catch(f=>{console.log("err: ",f)})};return K({open:z,reset_default:q}),(m,f)=>{const x=a("AppIcon"),S=a("el-button"),$=a("el-dialog");return k(),X(he,null,[l($,{"align-center":"",title:m.$t("common.paramSetting"),modelValue:y.value,"onUpdate:modelValue":f[2]||(f[2]=g=>y.value=g),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[u("div",bl,[l(S,{onClick:o,loading:n.value},{default:e(()=>[l(x,{iconName:"app-video-play",class:"mr-4"}),C(" "+c(m.$t("views.application.form.voicePlay.listeningTest")),1)]),_:1},8,["loading"]),u("span",kl,[l(S,{onClick:f[1]||(f[1]=ee(g=>y.value=!1,["prevent"]))},{default:e(()=>[C(c(m.$t("common.cancel")),1)]),_:1}),l(S,{type:"primary",onClick:U,loading:r.value},{default:e(()=>[C(c(m.$t("common.confirm")),1)]),_:1},8,["loading"])])])]),default:e(()=>[l(De,{modelValue:p.value,"onUpdate:modelValue":f[0]||(f[0]=g=>p.value=g),model:p.value,"label-position":"top","require-asterisk-position":"right",render_data:R.value,ref_key:"dynamicsFormRef",ref:h},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"]),u("audio",{ref_key:"audioPlayer",ref:t,controls:"",hidden:"hidden"},null,512)],64)}}}),$l={class:"flex-between"},Vl={class:"dialog-footer"},Wl=ne({__name:"STTModelParamSettingDialog",emits:["refresh"],setup(Q,{expose:K,emit:H}){const E=fe(),{params:{id:M}}=E,v=Z(()=>E.path.includes("resource-management")?"systemManage":"workspace"),T=s(!1),R=s({}),i=s(),h=s(""),p=s(!1),y=s([]),r=H,n=(U,t,o)=>{R.value={},h.value=U,de({type:"model",systemType:v.value}).getModelParamsForm(U,p).then(m=>{var x;y.value=m.data;const f=m.data.map(S=>({[S.field]:S.show_default_value!==!1?S.default_value:void 0})).reduce((S,$)=>({...S,...$}),{});o&&Object.keys(o).forEach(S=>{S in f||delete o[S]}),o={...f,...o},(x=i.value)==null||x.render(y.value,o)}),T.value=!0},z=async()=>{var U;(U=i.value)==null||U.validate().then(()=>{r("refresh",R.value),T.value=!1})};return K({open:n,reset_default:(U,t)=>{de({type:"model",systemType:v.value}).getModelParamsForm(U,p).then(o=>{y.value=o.data;const m=o.data.map(f=>({[f.field]:f.show_default_value!==!1?f.default_value:void 0})).reduce((f,x)=>({...f,...x}),{});r("refresh",m)})}}),(U,t)=>{const o=a("el-button"),m=a("el-dialog");return k(),A(m,{"align-center":"",title:U.$t("common.paramSetting"),modelValue:T.value,"onUpdate:modelValue":t[2]||(t[2]=f=>T.value=f),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[u("div",$l,[u("span",Vl,[l(o,{onClick:t[1]||(t[1]=ee(f=>T.value=!1,["prevent"]))},{default:e(()=>[C(c(U.$t("common.cancel")),1)]),_:1}),l(o,{type:"primary",onClick:z,loading:p.value},{default:e(()=>[C(c(U.$t("common.confirm")),1)]),_:1},8,["loading"])])])]),default:e(()=>[l(De,{modelValue:R.value,"onUpdate:modelValue":t[0]||(t[0]=f=>R.value=f),model:R.value,"label-position":"top","require-asterisk-position":"right",render_data:y.value,ref_key:"dynamicsFormRef",ref:i},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"])}}}),Cl={class:"dialog-footer p-16"},jl=ne({__name:"ReasoningParamSettingDialog",emits:["refresh"],setup(Q,{expose:K,emit:H}){const E=H,M=s({reasoning_content_start:"<think>",reasoning_content_end:"</think>"}),v=s(!1),T=s(!1);oe(v,h=>{h||(M.value={reasoning_content_start:"<think>",reasoning_content_end:"</think>"})});const R=h=>{M.value={...M.value,...h},v.value=!0},i=()=>{E("refresh",M.value),v.value=!1};return K({open:R}),(h,p)=>{const y=a("el-text"),r=a("el-input"),n=a("el-form-item"),z=a("el-col"),q=a("el-row"),U=a("el-form"),t=a("el-button"),o=a("el-dialog");return k(),A(o,{"align-center":"",title:h.$t("common.setting"),class:"param-dialog",modelValue:v.value,"onUpdate:modelValue":p[4]||(p[4]=m=>v.value=m),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[u("span",Cl,[l(t,{onClick:p[2]||(p[2]=ee(m=>v.value=!1,["prevent"]))},{default:e(()=>[C(c(h.$t("common.cancel")),1)]),_:1}),l(t,{type:"primary",onClick:p[3]||(p[3]=m=>i()),loading:T.value},{default:e(()=>[C(c(h.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[l(U,{"label-position":"top",ref:"paramFormRef",model:M.value},{default:e(()=>[l(y,{type:"info",class:"color-secondary"},{default:e(()=>[C(c(h.$t("views.application.form.reasoningContent.tooltip")),1)]),_:1}),l(q,{class:"mt-16",gutter:20},{default:e(()=>[l(z,{span:12},{default:e(()=>[l(n,{label:h.$t("views.application.form.reasoningContent.start")},{default:e(()=>[l(r,{type:"textarea",modelValue:M.value.reasoning_content_start,"onUpdate:modelValue":p[0]||(p[0]=m=>M.value.reasoning_content_start=m),rows:6,maxlength:"50",placeholder:"<think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),l(z,{span:12},{default:e(()=>[l(n,{label:h.$t("views.application.form.reasoningContent.end")},{default:e(()=>[l(r,{type:"textarea",modelValue:M.value.reasoning_content_end,"onUpdate:modelValue":p[1]||(p[1]=m=>M.value.reasoning_content_end=m),rows:6,maxlength:"50",placeholder:"</think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}}),Sl={class:"flex align-center"},Dl=["src"],Tl={class:"dialog-footer"},Rl=`{
  "math": {
    "url": "your_server",
    "transport": "sse"
  }
}`,Gl=ne({__name:"McpServersDialog",emits:["refresh"],setup(Q,{expose:K,emit:H}){const E=H,M=s(),v=s({mcp_servers:"",mcp_tool_ids:[],mcp_source:"referencing"}),T=s([]),R=s(!1),i=s(!1);oe(R,r=>{var n;r||(v.value={mcp_servers:"",mcp_tool_ids:[],mcp_source:"referencing"},(n=M.value)==null||n.clearValidate())});function h(){v.value.mcp_source==="referencing"?v.value.mcp_servers="":v.value.mcp_tool_ids=[]}const p=(r,n)=>{v.value={...v.value,...r},r.mcp_servers&&Object.keys(r.mcp_servers).length>0?v.value.mcp_source="custom":r.mcp_tool_ids?(v.value.mcp_source="referencing",v.value.mcp_tool_ids=r.mcp_tool_ids,v.value.mcp_servers=""):v.value.mcp_source=r.mcp_source||"referencing",R.value=!0,T.value=n||[]},y=()=>{M.value.validate(r=>{if(r){try{JSON.parse(v.value.mcp_servers||"{}")}catch{Te(Y("views.applicationWorkflow.nodes.mcpNode.mcpServerTip"));return}E("refresh",v.value),R.value=!1}})};return K({open:p}),(r,n)=>{const z=a("el-radio"),q=a("el-radio-group"),U=a("el-form-item"),t=a("el-avatar"),o=a("el-tag"),m=a("el-option"),f=a("el-select"),x=a("el-text"),S=a("el-input"),$=a("el-form"),g=a("el-button"),D=a("el-dialog");return k(),A(D,{"align-center":"",title:r.$t("common.setting"),modelValue:R.value,"onUpdate:modelValue":n[6]||(n[6]=b=>R.value=b),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[u("span",Tl,[l(g,{onClick:n[4]||(n[4]=ee(b=>R.value=!1,["prevent"]))},{default:e(()=>[C(c(r.$t("common.cancel")),1)]),_:1}),l(g,{type:"primary",onClick:n[5]||(n[5]=b=>y()),loading:i.value},{default:e(()=>[C(c(r.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[l($,{"label-position":"top",ref_key:"paramFormRef",ref:M,model:v.value,"require-asterisk-position":"right","hide-required-asterisk":"",onSubmit:n[3]||(n[3]=ee(()=>{},["prevent"]))},{default:e(()=>[l(U,null,{default:e(()=>[l(q,{modelValue:v.value.mcp_source,"onUpdate:modelValue":n[0]||(n[0]=b=>v.value.mcp_source=b),onChange:h},{default:e(()=>[l(z,{value:"referencing"},{default:e(()=>[C(c(r.$t("views.applicationWorkflow.nodes.mcpNode.reference")),1)]),_:1}),l(z,{value:"custom"},{default:e(()=>[C(c(r.$t("common.custom")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),v.value.mcp_source==="referencing"?(k(),A(U,{key:0,rules:[{required:!0,message:r.$t("common.selectPlaceholder")+` MCP ${r.$t("views.tool.title")}`}],prop:"mcp_tool_ids"},{label:e(()=>[C(c(`MCP ${r.$t("views.tool.title")}`)+" ",1),n[7]||(n[7]=u("span",{class:"color-danger"},"*",-1))]),default:e(()=>[l(f,{modelValue:v.value.mcp_tool_ids,"onUpdate:modelValue":n[1]||(n[1]=b=>v.value.mcp_tool_ids=b),filterable:"",multiple:"","reserve-keyword":!1},{default:e(()=>[(k(!0),X(he,null,Ve(T.value,b=>(k(),A(m,{key:b.id,label:b.name,value:b.id},{default:e(()=>[u("div",Sl,[b!=null&&b.icon?(k(),A(t,{key:0,shape:"square",size:20,style:{background:"none"},class:"mr-8"},{default:e(()=>[u("img",{src:ke(Re)(b==null?void 0:b.icon),alt:""},null,8,Dl)]),_:2},1024)):(k(),A(t,{key:1,shape:"square",size:20,class:"mr-8"},{default:e(()=>[...n[8]||(n[8]=[u("img",{src:Ee,style:{width:"75%"},alt:""},null,-1)])]),_:1})),u("span",null,c(b.name),1),b.scope==="SHARED"?(k(),A(o,{key:2,type:"info",class:"info-tag ml-8 mt-4"},{default:e(()=>[C(c(r.$t("views.shared.title")),1)]),_:1})):G("",!0)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])):(k(),A(U,{key:1,prop:"mcp_servers",rules:[{required:!0,message:r.$t("common.inputPlaceholder")+" "+r.$t("views.tool.form.mcp.label")}]},{label:e(()=>[C(c(r.$t("views.tool.form.mcp.label"))+" ",1),n[9]||(n[9]=u("span",{class:"color-danger"},"*",-1)),l(x,{type:"info",class:"color-secondary"},{default:e(()=>[C(" ï¼ˆ"+c(r.$t("views.tool.form.mcp.tip"))+"ï¼‰ ",1)]),_:1})]),default:e(()=>[l(S,{modelValue:v.value.mcp_servers,"onUpdate:modelValue":n[2]||(n[2]=b=>v.value.mcp_servers=b),rows:6,type:"textarea",placeholder:Rl},null,8,["modelValue"])]),_:1},8,["rules"]))]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}}),Ul={class:"flex-between mb-8"},xl={class:"flex"},Pl=["id"],Al={class:"p-8"},Il={class:"layout-bg"},Ll={class:"flex-between p-16 ml-8"},ql={class:"p-16-24 pt-0",style:{height:"calc(100vh - 200px)"}},Ml=["src"],zl=["title"],Fl={class:"flex-between"},Nl={class:"flex"},Jl=ne({__name:"ToolDialog",emits:["refresh"],setup(Q,{expose:K,emit:H}){const E=fe(),M=H,{folder:v,user:T}=be();Z(()=>E.path.includes("shared")?"systemShare":E.path.includes("resource-management")?"systemManage":"workspace");const R=s(!1),i=s([]),h=s(""),p=s([]),y=s([]),r=s(!1);oe(R,g=>{g||(i.value=[],h.value="",p.value=[],y.value=[])}),oe(h,g=>{g?p.value=y.value.filter(D=>D.name.includes(g)):p.value=y.value});function n(){}function z(){i.value=[]}const q=g=>{i.value=g||[],S(),R.value=!0},U=()=>{M("refresh",{tool_ids:i.value}),R.value=!1},t=()=>{h.value="",y.value=[],$()},o=s([]),m=s({}),f=s(!1);function x(g){var D;g.id!==((D=m.value)==null?void 0:D.id)&&(m.value=g,$())}function S(){const g={};v.asyncGetFolder("TOOL",g,f).then(D=>{var b;o.value=D.data,m.value=((b=D.data)==null?void 0:b[0])||{},$()})}function $(){var D;const g=((D=m.value)==null?void 0:D.id)||T.getWorkspaceId();de({type:"tool",isShared:g==="share",systemType:"workspace"}).getToolList({folder_id:g,tool_type:"CUSTOM"}).then(b=>{var O,_,V;y.value=((O=b.data)==null?void 0:O.tools)||b.data||[],y.value=(_=y.value)==null?void 0:_.filter(L=>L.is_active),p.value=b.data.tools||b.data,p.value=(V=p.value)==null?void 0:V.filter(L=>L.is_active)})}return K({open:q}),(g,D)=>{const b=a("Refresh"),O=a("el-icon"),_=a("el-button"),V=a("folder-tree"),L=a("el-input"),le=a("el-avatar"),ae=a("ToolIcon"),j=a("CardCheckbox"),te=a("el-col"),se=a("el-row"),W=a("el-empty"),I=a("el-scrollbar"),ie=a("LayoutContainer"),pe=a("el-text"),me=a("el-dialog"),d=$e("loading");return k(),A(me,{modelValue:R.value,"onUpdate:modelValue":D[3]||(D[3]=w=>R.value=w),width:"1000","append-to-body":"",class:"addTool-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:w,titleClass:P})=>[u("div",Ul,[u("div",xl,[u("h4",{id:w,class:ve([P,"mr-8"])},c(g.$t("views.tool.settingTool")),11,Pl)]),l(_,{link:"",class:"mr-24",onClick:t},{default:e(()=>[l(O,{size:18},{default:e(()=>[l(b)]),_:1})]),_:1})])]),footer:e(()=>[u("div",Fl,[u("div",Nl,[i.value.length>0?(k(),A(pe,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[C(c(g.$t("common.selected"))+" "+c(i.value.length),1)]),_:1})):G("",!0),i.value.length>0?(k(),A(_,{key:1,link:"",type:"primary",onClick:z},{default:e(()=>[C(c(g.$t("common.clear")),1)]),_:1})):G("",!0)]),u("span",null,[l(_,{onClick:D[2]||(D[2]=ee(w=>R.value=!1,["prevent"]))},{default:e(()=>[C(c(g.$t("common.cancel")),1)]),_:1}),l(_,{type:"primary",onClick:U},{default:e(()=>[C(c(g.$t("common.add")),1)]),_:1})])])]),default:e(()=>[l(ie,{class:"application-manage"},{left:e(()=>{var w;return[u("div",Al,[ce(l(V,{data:o.value,currentNodeKey:(w=m.value)==null?void 0:w.id,onHandleNodeClick:x,canOperation:!1,showShared:"",shareTitle:g.$t("views.shared.shared_tool"),treeStyle:{height:"calc(100vh - 240px)"}},null,8,["data","currentNodeKey","shareTitle"]),[[d,f.value]])])]}),default:e(()=>{var w;return[u("div",Il,[u("div",Ll,[u("h4",null,c((w=m.value)==null?void 0:w.name),1),l(L,{modelValue:h.value,"onUpdate:modelValue":D[0]||(D[0]=P=>h.value=P),placeholder:g.$t("common.search"),"prefix-icon":"Search",class:"w-240 mr-8",clearable:""},null,8,["modelValue","placeholder"])]),l(I,null,{default:e(()=>[u("div",ql,[p.value.length?ce((k(),A(se,{key:0,gutter:12},{default:e(()=>[(k(!0),X(he,null,Ve(p.value,(P,F)=>(k(),A(te,{span:12,key:F,class:"mb-16"},{default:e(()=>[l(j,{"value-field":"id",data:P,modelValue:i.value,"onUpdate:modelValue":D[1]||(D[1]=N=>i.value=N),onChange:n},{icon:e(()=>[P!=null&&P.icon?(k(),A(le,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-8"},{default:e(()=>[u("img",{src:ke(Re)(P==null?void 0:P.icon),alt:""},null,8,Ml)]),_:2},1024)):(k(),A(ae,{key:1,size:32,type:P==null?void 0:P.tool_type},null,8,["type"]))]),default:e(()=>[u("span",{class:"ellipsis cursor ml-12",title:P.name},c(P.name),9,zl)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[d,r.value]]):(k(),A(W,{key:1,description:g.$t("common.noData")},null,8,["description"]))])]),_:1})])]}),_:1})]),_:1},8,["modelValue"])}}});export{Kl as G,Bl as _,Wl as a,Hl as b,Ol as c,jl as d,Gl as e,Jl as f};
