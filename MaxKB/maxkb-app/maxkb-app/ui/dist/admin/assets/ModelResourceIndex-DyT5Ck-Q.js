import{ay as ke,aA as $e,aB as r,aU as Ce,aO as Y,aQ as Me,aV as Ve,b6 as Te,aL as Le,aD as n,aW as E,aF as s,aH as t,aG as o,aK as v,aJ as u,b2 as b,aC as k,aI as i,aE as d,b1 as h,aX as B,aY as D,c3 as Se,c4 as Ae,aS as $,bZ as Z,bW as Ee,b_ as Re,c0 as ze,c5 as ee,b3 as Ne}from"./admin-Ca7cl6NN.js";import{E as Fe,_ as xe}from"./ParamSettingDialog.vue_vue_type_script_setup_true_lang-CzFrIreJ.js";import{l as Pe}from"./permission-api-BDoWsP34.js";import"./workspace-CiflQXiK.js";const Be={class:"p-16-24"},De={class:"ml-4 color-text-primary"},Ue={class:"flex-between mb-16"},Ie={class:"complex-search"},He=["innerHTML"],We=["innerHTML"],Ge={class:"filter"},Oe={class:"form-item mb-16 ml-4"},Je={class:"text-right"},je={class:"mr-8"},qe={class:"mr-8"},el=ke({__name:"ModelResourceIndex",setup(Ke){const{user:U,model:le}=$e(),C=r("name"),m=r({name:"",create_user:"",model_type:""}),R=r(!1),I=r([]),H=r([]),z=r([]),N=Ce({current_page:1,page_size:20,total:0}),te=()=>g.value.delete()||g.value.modify(),W=r();function oe(e){W.value.open(e.id)}const ae=e=>{ze(`${k("views.model.delete.confirmTitle")}${e.name} ?`,k("views.model.delete.confirmMessage"),{confirmButtonText:k("common.confirm"),confirmButtonClass:"danger"}).then(()=>{ee.deleteModel(e.id).then(()=>{c(),Ne(k("common.deleteSuccess"))})}).catch(()=>{})},G=r(),ne=e=>{var a;(a=G.value)==null||a.open(e)},O=r(),se=e=>{var f;const a=z.value.find(x=>x.provider===e.provider);a&&((f=O.value)==null||f.open(a,e))},g=Y(()=>Me.model.systemManage),L=r([]),S=r(!1),y=r([]),F=Y(()=>e=>z.value.find(a=>a.provider===e.provider)),M=r(""),A=r([]);Ve([()=>L.value,()=>M.value],()=>{M.value.length||(A.value=L.value),A.value=L.value.filter(e=>e.label.toLowerCase().includes(M.value.toLowerCase()))},{immediate:!0});function J(e){e==="clear"&&(y.value=[]),c(),S.value=!1}async function ie(){if(U.isEE()){const e=await Pe("workspace").getSystemWorkspaceList(R);L.value=e.data.map(a=>({label:a.name,value:a.id}))}}const re=()=>{m.value={name:"",create_user:"",model_type:""}};function de(){const e={name:m.value.name,create_user:m.value.create_user,model_type:m.value.model_type};return y.value.length>0&&(e.workspace_ids=JSON.stringify(y.value)),e}function c(){ee.getModelListPage(N,de(),R).then(e=>{var a,f;N.total=(a=e.data)==null?void 0:a.total,I.value=(f=e.data)==null?void 0:f.records})}function ue(){le.asyncGetProvider(R).then(e=>{z.value=e==null?void 0:e.data,c()})}return Te(()=>{ie(),ue(),Le.getAllMemberList("").then(e=>{H.value=e.data})}),(e,a)=>{const f=n("el-breadcrumb-item"),x=n("el-breadcrumb"),V=n("el-option"),P=n("el-select"),j=n("el-input"),q=n("el-space"),p=n("el-table-column"),me=n("Filter"),ce=n("el-icon"),w=n("el-button"),pe=n("el-checkbox"),_e=n("el-checkbox-group"),ve=n("el-scrollbar"),fe=n("el-empty"),be=n("el-popover"),T=n("AppIcon"),K=n("el-tooltip"),Q=n("el-dropdown-item"),ye=n("el-dropdown-menu"),he=n("el-dropdown"),ge=n("app-table"),we=n("el-card");return s(),E("div",Be,[t(x,{"separator-icon":"ArrowRight"},{default:o(()=>[t(f,null,{default:o(()=>[v(u(b(k)("views.system.resource_management.label")),1)]),_:1}),t(f,null,{default:o(()=>[i("h5",De,u(b(k)("views.model.title")),1)]),_:1})]),_:1}),t(we,{class:"mt-16",style:{height:"calc(var(--app-main-height) + 20px)"}},{default:o(()=>[i("div",Ue,[i("div",Ie,[t(P,{class:"complex-search__left",modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=l=>C.value=l),style:{width:"120px"},onChange:re},{default:o(()=>[t(V,{label:e.$t("common.creator"),value:"create_user"},null,8,["label"]),t(V,{label:e.$t("views.model.modelForm.model_type.label"),value:"model_type"},null,8,["label"]),t(V,{label:e.$t("views.model.modelForm.modeName.label"),value:"name"},null,8,["label"])]),_:1},8,["modelValue"]),C.value==="name"?(s(),d(j,{key:0,modelValue:m.value.name,"onUpdate:modelValue":a[1]||(a[1]=l=>m.value.name=l),onChange:c,placeholder:e.$t("common.searchBar.placeholder"),style:{width:"220px"},clearable:""},null,8,["modelValue","placeholder"])):C.value==="create_user"?(s(),d(P,{key:1,modelValue:m.value.create_user,"onUpdate:modelValue":a[2]||(a[2]=l=>m.value.create_user=l),onChange:c,filterable:"",clearable:"",style:{width:"220px"}},{default:o(()=>[(s(!0),E(B,null,D(H.value,l=>(s(),d(V,{key:l.id,value:l.id,label:l.nick_name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])):C.value==="model_type"?(s(),d(P,{key:2,modelValue:m.value.model_type,"onUpdate:modelValue":a[3]||(a[3]=l=>m.value.model_type=l),clearable:"",onChange:c,style:{width:"220px"}},{default:o(()=>[(s(!0),E(B,null,D(b(Se),l=>(s(),d(V,{key:l.value,label:l.text,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):h("",!0)])]),t(ge,{data:I.value,"pagination-config":N,onSizeChange:c,onChangePage:c,maxTableHeight:260},{default:o(()=>[t(p,{width:"220",label:e.$t("common.name"),"show-overflow-tooltip":""},{default:o(({row:l})=>[t(q,{size:8},{default:o(()=>{var _;return[i("span",{style:{width:"24px",height:"24px",display:"inline-block"},innerHTML:(_=F.value(l))==null?void 0:_.icon},null,8,He),i("span",null,u(l.name),1)]}),_:2},1024)]),_:1},8,["label"]),t(p,{prop:"provider",label:e.$t("views.model.provider"),"show-overflow-tooltip":"",width:"150"},{default:o(({row:l})=>[t(q,{size:8},{default:o(()=>{var _,X;return[i("span",{style:{width:"24px",height:"24px",display:"inline-block"},innerHTML:(_=F.value(l))==null?void 0:_.icon},null,8,We),i("span",null,u((X=F.value(l))==null?void 0:X.name),1)]}),_:2},1024)]),_:1},8,["label"]),t(p,{width:"120",label:e.$t("views.model.modelForm.model_type.label")},{default:o(({row:l})=>[v(u(e.$t(b(Ae)[l.model_type])),1)]),_:1},8,["label"]),t(p,{width:"220",label:e.$t("views.model.modelForm.base_model.label"),"show-overflow-tooltip":""},{default:o(({row:l})=>[v(u(l.model_name),1)]),_:1},8,["label"]),b(U).isEE()?(s(),d(p,{key:0,width:"150",prop:"workspace_name",label:e.$t("views.workspace.title"),"show-overflow-tooltip":""},{header:o(()=>[i("div",null,[i("span",null,u(e.$t("views.workspace.title")),1),t(be,{width:200,trigger:"click",visible:S.value},{reference:o(()=>[t(w,{style:{"margin-top":"-2px"},type:y.value&&y.value.length>0?"primary":"",link:"",onClick:a[4]||(a[4]=l=>S.value=!S.value)},{default:o(()=>[t(ce,null,{default:o(()=>[t(me)]),_:1})]),_:1},8,["type"])]),default:o(()=>[i("div",Ge,[i("div",Oe,[i("div",{onClick:a[7]||(a[7]=$(()=>{},["stop"]))},[t(j,{modelValue:M.value,"onUpdate:modelValue":a[5]||(a[5]=l=>M.value=l),placeholder:e.$t("common.search"),"prefix-icon":"Search",clearable:""},null,8,["modelValue","placeholder"]),A.value.length?(s(),d(ve,{key:0,height:"300"},{default:o(()=>[t(_e,{modelValue:y.value,"onUpdate:modelValue":a[6]||(a[6]=l=>y.value=l),style:{display:"flex","flex-direction":"column"}},{default:o(()=>[(s(!0),E(B,null,D(A.value,l=>(s(),d(pe,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(s(),d(fe,{key:1,description:e.$t("common.noData")},null,8,["description"]))])])]),i("div",Je,[t(w,{size:"small",onClick:a[8]||(a[8]=l=>J("clear"))},{default:o(()=>[v(u(e.$t("common.clear")),1)]),_:1}),t(w,{type:"primary",onClick:J,size:"small"},{default:o(()=>[v(u(e.$t("common.confirm")),1)]),_:1})])]),_:1},8,["visible"])])]),_:1},8,["label"])):h("",!0),t(p,{prop:"nick_name",label:e.$t("common.creator"),"show-overflow-tooltip":""},null,8,["label"]),t(p,{label:e.$t("views.document.table.updateTime"),width:"180"},{default:o(({row:l})=>[v(u(b(Z)(l.update_time)),1)]),_:1},8,["label"]),t(p,{label:e.$t("common.createTime"),width:"180"},{default:o(({row:l})=>[v(u(b(Z)(l.create_time)),1)]),_:1},8,["label"]),t(p,{label:e.$t("common.operation"),align:"left",width:"120",fixed:"right"},{default:o(({row:l})=>[g.value.modify()?(s(),d(K,{key:0,effect:"dark",content:e.$t("common.modify"),placement:"top"},{default:o(()=>[i("span",je,[t(w,{type:"primary",text:"",title:e.$t("common.modify"),onClick:$(_=>se(l),["stop"])},{default:o(()=>[t(T,{iconName:"app-edit"})]),_:1},8,["title","onClick"])])]),_:2},1032,["content"])):h("",!0),g.value.auth()?(s(),d(K,{key:1,effect:"dark",content:e.$t("views.system.resourceAuthorization.title"),placement:"top"},{default:o(()=>[i("span",qe,[t(w,{type:"primary",text:"",title:e.$t("views.system.resourceAuthorization.title"),onClick:$(_=>oe(l),["stop"])},{default:o(()=>[t(T,{iconName:"app-resource-authorization"})]),_:1},8,["title","onClick"])])]),_:2},1032,["content"])):h("",!0),te()?(s(),d(he,{key:2,trigger:"click"},{dropdown:o(()=>[t(ye,null,{default:o(()=>[["TTS","LLM","IMAGE","TTI","STT","EMBEDDING"].includes(l.model_type)&&g.value.paramSetting()?(s(),d(Q,{key:0,onClick:$(_=>ne(l),["stop"])},{default:o(()=>[t(T,{iconName:"app-setting",class:"color-secondary"}),v(" "+u(e.$t("views.model.modelForm.title.paramSetting")),1)]),_:1},8,["onClick"])):h("",!0),g.value.delete()?(s(),d(Q,{key:1,onClick:$(_=>ae(l),["stop"])},{default:o(()=>[t(T,{iconName:"app-delete",class:"color-secondary"}),v(" "+u(e.$t("common.delete")),1)]),_:1},8,["onClick"])):h("",!0)]),_:2},1024)]),default:o(()=>[t(w,{text:"",onClick:a[9]||(a[9]=$(()=>{},["stop"])),type:"primary"},{default:o(()=>[t(T,{iconName:"app-more"})]),_:1})]),_:2},1024)):h("",!0)]),_:1},8,["label"])]),_:1},8,["data","pagination-config"])]),_:1}),t(Fe,{ref_key:"editModelRef",ref:O,onSubmit:c},null,512),t(xe,{ref_key:"paramSettingRef",ref:G},null,512),t(Re,{type:b(Ee).MODEL,ref_key:"ResourceAuthorizationDrawerRef",ref:W},null,8,["type"])])}}});export{el as default};
