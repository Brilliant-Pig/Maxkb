import{ay as ae,b8 as oe,b7 as j,aB as m,aC as F,aD as u,bs as re,aE as k,aF as b,aG as l,bt as G,ba as me,aH as t,aI as i,aJ as c,bf as S,bg as O,bh as x,bm as ie,aK as C,cJ as H,bc as D,bo as te,ce as ue,bn as pe,cK as ce,bb as ee,cL as _e,c7 as le}from"./chat-CUfIjAsy.js";const fe={class:"active-breadcrumb"},ve={class:"flex align-center",style:{display:"inline-flex"}},be={class:"mr-4"},ye={class:"flex align-center",style:{display:"inline-flex"}},ge={class:"mr-4"},he={class:"color-danger ml-4",style:{color:"red"}},we={class:"flex align-center",style:{display:"inline-flex"}},$e={class:"flex-between mr-4"},ke={class:"dialog-footer"},Fe=ae({__name:"EditModel",emits:["change","submit"],setup(ne,{expose:E,emit:U}){const N=oe(),g=j(()=>N.path.includes("shared")?"systemShare":N.path.includes("resource-management")?"systemManage":"workspace"),y=m(),_=m(),B=U,V=m(!1),I=m(!1),$=m(!1),q=m(!1),R=m([]),h=m(),T=m([]),o=m([]),s=m(!1),r=m({name:{required:!0,trigger:"blur",message:F("views.model.modelForm.modeName.requiredMessage")},model_type:{required:!0,trigger:"change",message:F("views.model.modelForm.model_type.requiredMessage")},model_name:{required:!0,trigger:"change",message:F("views.model.modelForm.base_model.requiredMessage")}}),d=m({name:"",model_type:"",model_name:""}),f=m({}),v=j({get:()=>({...f.value,...d.value}),set:a=>{f.value=a}}),A=a=>{y.value&&H.getModelCreateForm(y.value.provider,v.value.model_type,a).then(e=>{var w;o.value=e.data,h.value&&((w=_.value)==null||w.render(o.value,h.value.credential))})},P=(a,e)=>{e&&(d.value.model_name=""),y.value&&H.listBaseModel(y.value.provider,a,q).then(w=>{T.value=w.data})},L=(a,e)=>{h.value=e,D({type:"model",systemType:g.value}).getModelById(e.id,I).then(w=>{h.value=w.data,H.listModelType(e.provider,$).then(J=>{R.value=J.data,P(e.model_type)}),y.value=a,d.value={name:e.name,model_type:e.model_type,model_name:e.model_name},v.value=e.credential,A(e.model_name)}),s.value=!0},M=()=>{var a,e;d.value={name:"",model_type:"",model_name:""},(e=(a=_.value)==null?void 0:a.ruleFormRef)==null||e.resetFields(),f.value={},o.value=[],T.value=[],s.value=!1},p=()=>{var a;(a=_.value)==null||a.validate().then(()=>{h.value&&D({type:"model",systemType:g.value}).updateModel(h.value.id,{...d.value,credential:f.value},V).then(e=>{te(F("views.model.tip.updateSuccessMessage")),M(),B("submit")})})};return E({open:L,close:M}),(a,e)=>{const w=u("el-breadcrumb-item"),J=u("el-breadcrumb"),Q=u("AppIcon"),W=u("el-tooltip"),se=u("el-input"),K=u("el-form-item"),X=u("el-option"),Y=u("el-select"),Z=u("el-button"),de=u("el-dialog"),z=re("loading");return b(),k(de,{modelValue:s.value,"onUpdate:modelValue":e[6]||(e[6]=n=>s.value=n),width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,"before-close":M},{header:l(()=>[t(J,{separator:">"},{default:l(()=>[t(w,null,{default:l(()=>{var n;return[i("span",fe,c(`${a.$t("common.edit")} ${(n=y.value)==null?void 0:n.name}`),1)]}),_:1})]),_:1})]),footer:l(()=>[i("span",ke,[t(Z,{onClick:M},{default:l(()=>[C(c(a.$t("common.cancel")),1)]),_:1}),t(Z,{type:"primary",onClick:p,loading:V.value},{default:l(()=>[C(c(a.$t("common.modify")),1)]),_:1},8,["loading"])])]),default:l(()=>[G((b(),k(me,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=n=>v.value=n),render_data:o.value,model:v.value,ref_key:"dynamicsFormRef",ref:_,"label-position":"top","require-asterisk-position":"right"},{default:l(()=>[t(K,{prop:"name",rules:r.value.name},{label:l(()=>[i("div",ve,[i("div",be,[i("span",null,c(a.$t("views.model.modelForm.modeName.label")),1)]),t(W,{effect:"dark",placement:"right"},{content:l(()=>[i("p",null,c(a.$t("views.model.modelForm.modeName.tooltip")),1)]),default:l(()=>[t(Q,{iconName:"app-warning",class:"app-warning-icon"})]),_:1})])]),default:l(()=>[t(se,{modelValue:d.value.name,"onUpdate:modelValue":e[0]||(e[0]=n=>d.value.name=n),maxlength:"64","show-word-limit":"",placeholder:a.$t("views.model.modelForm.modeName.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["rules"]),t(K,{prop:"model_type",rules:r.value.model_type},{label:l(()=>[i("span",null,c(a.$t("views.model.modelForm.model_type.label")),1)]),default:l(()=>[G((b(),k(Y,{disabled:"",onChange:e[1]||(e[1]=n=>P(n,!0)),modelValue:d.value.model_type,"onUpdate:modelValue":e[2]||(e[2]=n=>d.value.model_type=n),class:"w-full m-2",placeholder:a.$t("views.model.modelForm.model_type.placeholder")},{default:l(()=>[(b(!0),S(O,null,x(R.value,n=>(b(),k(X,{key:n.value,label:n.key,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])),[[z,$.value]])]),_:1},8,["rules"]),t(K,{prop:"model_name",rules:r.value.model_name},{label:l(()=>[i("div",ye,[i("div",ge,[i("span",null,c(a.$t("views.model.modelForm.base_model.label")),1),i("span",he,c(a.$t("views.model.modelForm.base_model.tooltip")),1)])])]),default:l(()=>[G((b(),k(Y,{onChange:e[3]||(e[3]=n=>A(n)),modelValue:d.value.model_name,"onUpdate:modelValue":e[4]||(e[4]=n=>d.value.model_name=n),class:"w-full m-2",placeholder:a.$t("views.model.modelForm.base_model.requiredMessage"),filterable:"","allow-create":"","default-first-option":""},{default:l(()=>[(b(!0),S(O,null,x(T.value,n=>(b(),k(X,{key:n.name,value:n.name},{default:l(()=>[i("div",we,[i("div",$e,[i("span",null,c(n.name),1)]),n.desc?(b(),k(W,{key:0,effect:"dark",placement:"right"},{content:l(()=>[i("p",null,c(n.desc),1)]),default:l(()=>[t(Q,{iconName:"app-warning",class:"app-warning-icon"})]),_:2},1024)):ie("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","placeholder"])),[[z,q.value]])]),_:1},8,["rules"])]),_:1},8,["modelValue","render_data","model"])),[[z,I.value]])]),_:1},8,["modelValue"])}}}),Te=ue(Fe,[["__scopeId","data-v-a79a8501"]]),Ve={key:0},Me={key:1},Ce={class:"mr-4"},Ne={class:"dialog-footer"},Ae=ae({__name:"ParamSettingDialog",setup(ne,{expose:E}){const U=oe(),N=j(()=>U.path.includes("shared")?"systemShare":U.path.includes("resource-management")?"systemManage":"workspace"),g=m(!1),y=m(!1),_=m([]),B=m(),V=m(null),I=o=>{V.value=o,y.value=!0,g.value=!0,D({type:"model",systemType:N.value}).getModelParamsForm(o.id,g).then(s=>{g.value=!1,_.value=s.data}).catch(()=>{g.value=!1})},$=()=>{y.value=!1};function q(o,s){var r;(r=B.value)==null||r.open(o,s)}function R(o){_.value.splice(o,1)}function h(o,s){for(let r=0;r<_.value.length;r++){const d=_.value[r].field;let f=_.value[r].label;f&&f.input_type==="TooltipLabel"&&(f=f.label);let v=o.label;if(v&&v.input_type==="TooltipLabel"&&(v=v.label),d===o.field&&s!==r){le(F("views.model.tip.errorMessage")+o.field);return}if(f===v&&s!==r){le(F("views.model.tip.errorMessage")+f);return}}s!==null?_.value.splice(s,1,o):_.value.push(o)}function T(){V.value&&D({type:"model",systemType:N.value}).updateModelParamsForm(V.value.id,_.value,g).then(o=>{te(F("views.model.tip.saveSuccessMessage")),$()})}return E({open:I,close:$}),(o,s)=>{const r=u("el-button"),d=u("el-table-column"),f=u("el-tag"),v=u("el-switch"),A=u("AppIcon"),P=u("el-tooltip"),L=u("el-table"),M=u("el-dialog");return b(),S(O,null,[t(M,{title:o.$t("views.model.modelForm.title.paramSetting"),modelValue:y.value,"onUpdate:modelValue":s[2]||(s[2]=p=>y.value=p),width:"800px","close-on-click-modal":!1,"close-on-press-escape":!1,"destroy-on-close":!0,"before-close":$},{footer:l(()=>[i("span",Ne,[t(r,{onClick:$},{default:l(()=>[C(c(o.$t("common.cancel")),1)]),_:1}),t(r,{type:"primary",onClick:T,loading:g.value},{default:l(()=>[C(c(o.$t("common.save")),1)]),_:1},8,["loading"])])]),default:l(()=>[t(r,{type:"primary",onClick:s[0]||(s[0]=p=>q()),class:"mb-12"},{default:l(()=>[C(c(o.$t("common.param.addParam")),1)]),_:1}),t(L,{data:_.value,class:"mb-16"},{default:l(()=>[t(d,{prop:"label",label:o.$t("dynamicsForm.paramForm.name.label"),"show-overflow-tooltip":""},{default:l(({row:p})=>[p.label&&p.label.input_type==="TooltipLabel"?(b(),S("span",Ve,c(p.label.label),1)):(b(),S("span",Me,c(p.label),1))]),_:1},8,["label"]),t(d,{prop:"field",label:o.$t("dynamicsForm.paramForm.field.label"),"show-overflow-tooltip":""},null,8,["label"]),t(d,{label:o.$t("dynamicsForm.paramForm.input_type.label"),width:"110px"},{default:l(({row:p})=>[t(f,{type:"info",class:"info-tag"},{default:l(()=>{var a;return[C(c((a=pe(ce).find(e=>e.value===p.input_type))==null?void 0:a.label),1)]}),_:2},1024)]),_:1},8,["label"]),t(d,{prop:"default_value",label:o.$t("dynamicsForm.default.label"),"show-overflow-tooltip":""},null,8,["label"]),t(d,{label:o.$t("common.required")},{default:l(({row:p})=>[i("div",{onClick:s[1]||(s[1]=ee(()=>{},["stop"]))},[t(v,{disabled:"",size:"small",modelValue:p.required,"onUpdate:modelValue":a=>p.required=a},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["label"]),t(d,{label:o.$t("common.operation"),align:"left",width:"90"},{default:l(({row:p,$index:a})=>[i("span",Ce,[t(P,{effect:"dark",content:o.$t("common.modify"),placement:"top"},{default:l(()=>[t(r,{type:"primary",text:"",onClick:ee(e=>q(p,a),["stop"])},{default:l(()=>[t(A,{iconName:"app-edit"})]),_:1},8,["onClick"])]),_:2},1032,["content"])]),t(P,{effect:"dark",content:o.$t("common.delete"),placement:"top"},{default:l(()=>[t(r,{type:"primary",text:"",onClick:e=>R(a)},{default:l(()=>[t(A,{iconName:"app-delete"})]),_:1},8,["onClick"])]),_:2},1032,["content"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["title","modelValue"]),t(_e,{ref_key:"AddParamRef",ref:B,onRefresh:h},null,512)],64)}}});export{Te as E,Ae as _};
