import{bl as x,bj as I,ay as Z,aB as p,b7 as ee,aD as i,bs as oe,aE as T,aF as h,aG as a,aI as c,aH as l,bt as te,aJ as s,aK as m,bf as y,bm as ae,bg as H,bh as U}from"./chat-CUfIjAsy.js";import{l as le}from"./permission-api-DyNdOx42.js";const v="/system/shared",se=(r,n)=>I(`${v}/knowledge/${r}/authorization`,{},n),ne=(r,n,u)=>x(`${v}/knowledge/${r}/authorization`,n,u),ie=(r,n)=>I(`${v}/tool/${r}/authorization`,{},n),re=(r,n,u)=>x(`${v}/tool/${r}/authorization`,n,u),ce=(r,n)=>I(`${v}/model/${r}/authorization`,{},n),de=(r,n,u)=>x(`${v}/model/${r}/authorization`,n,u),F={getSharedAuthorizationKnowledge:se,postSharedAuthorizationKnowledge:ne,getSharedAuthorizationTool:ie,postSharedAuthorizationTool:re,getSharedAuthorizationModel:ce,postSharedAuthorizationModel:de},ue={class:"mb-8"},pe={class:"mb-8 lighter"},he={class:"mb-8 lighter mt-16"},me={class:"flex border",style:{overflow:"hidden"}},_e={class:"border-r"},ve={class:"mt-8"},fe={class:"flex"},ge=["title"],ke={class:"w-full"},we={class:"flex-between p-16"},be={class:"lighter"},$e={class:"flex align-center"},ye=["title"],Ae=Z({__name:"AuthorizedWorkspaceDialog",setup(r,{expose:n}){const u=p(!1),C=p(!0),d=p([]),_=p([]),g=p("WHITE_LIST"),k=p("");let L="",W="Knowledge";const z=p(!1),f=p(!1),M=ee(()=>_.value.filter(e=>e.name.includes(k.value))),P=e=>{d.value=e?_.value:[],C.value=!1,e||K()},V=e=>{const o=e.length;u.value=o===_.value.length,C.value=o>0&&o<_.value.length},j=async({id:e},o="Knowledge")=>{L=e,z.value=!0,W=o;const[w,b]=await Promise.all([F[`getSharedAuthorization${o}`](e),le("workspace").getSystemWorkspaceList()]);_.value=b.data,g.value=(w.data||{}).authentication_type||"WHITE_LIST";const A=(w.data||{}).workspace_id_list||[];d.value=_.value.filter(S=>A.includes(S.id)),V(d.value),z.value=!1,f.value=!0},G=()=>{F[`postSharedAuthorization${W}`](L,{workspace_id_list:d.value.map(e=>e.id),authentication_type:g.value}).then(()=>{f.value=!1})},J=e=>{d.value=d.value.filter(o=>o.id!==e.id)},K=()=>{d.value=[],V([])};return n({open:j}),(e,o)=>{const w=i("el-text"),b=i("el-radio"),A=i("el-radio-group"),S=i("Search"),B=i("el-icon"),q=i("el-input"),D=i("el-checkbox"),E=i("AppIcon"),O=i("el-checkbox-group"),N=i("el-scrollbar"),$=i("el-button"),Q=i("Close"),R=i("el-dialog"),X=oe("loading");return h(),T(R,{"modal-class":"authorized-workspace",modelValue:f.value,"onUpdate:modelValue":o[5]||(o[5]=t=>f.value=t),width:"840"},{header:a(()=>[c("h4",ue,s(e.$t("views.shared.authorized_workspace")),1),l(w,{class:"color-secondary lighter"},{default:a(()=>[m(s(e.$t("views.shared.authorized_tip")),1)]),_:1})]),footer:a(()=>[l($,{onClick:o[4]||(o[4]=t=>f.value=!1)},{default:a(()=>[m(s(e.$t("common.cancel")),1)]),_:1}),l($,{type:"primary",onClick:G},{default:a(()=>[m(s(e.$t("common.save")),1)]),_:1})]),default:a(()=>[c("p",pe,s(e.$t("views.shared.type")),1),l(A,{modelValue:g.value,"onUpdate:modelValue":o[0]||(o[0]=t=>g.value=t)},{default:a(()=>[l(b,{value:"WHITE_LIST"},{default:a(()=>[m(s(e.$t("views.shared.WHITE_LIST")),1)]),_:1}),l(b,{value:"BLACK_LIST"},{default:a(()=>[m(s(e.$t("views.shared.BLACK_LIST")),1)]),_:1})]),_:1},8,["modelValue"]),c("p",he,s(e.$t("views.shared.select_workspace")),1),te((h(),y("div",me,[c("div",_e,[l(q,{modelValue:k.value,"onUpdate:modelValue":o[1]||(o[1]=t=>k.value=t),"validate-event":!1,placeholder:e.$t("common.search"),style:{width:"364px",padding:"16px 16px 0 16px"},clearable:""},{prefix:a(()=>[l(B,null,{default:a(()=>[l(S)]),_:1})]),_:1},8,["modelValue","placeholder"]),c("div",ve,[k.value?ae("",!0):(h(),T(D,{key:0,class:"mb-8",style:{"margin-left":"16px"},modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=t=>u.value=t),indeterminate:C.value,onChange:P},{default:a(()=>[m(s(e.$t("views.shared.allCheck")),1)]),_:1},8,["modelValue","indeterminate"])),l(N,{"max-height":"205","wrap-class":"p-16 pt-0"},{default:a(()=>[l(O,{class:"checkbox-group-block",modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=t=>d.value=t),onChange:V},{default:a(()=>[(h(!0),y(H,null,U(M.value,t=>(h(),T(D,{key:t.id,label:t.name,value:t},{default:a(()=>[c("div",fe,[l(E,{iconName:"app-workspace"}),c("span",{class:"ml-4 ellipsis",title:t.name},s(t.name),9,ge)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})])]),c("div",ke,[c("div",we,[c("span",be,s(e.$t("common.selected"))+": "+s(d.value.length)+" ä¸ª ",1),l($,{onClick:K,link:"",type:"primary"},{default:a(()=>[m(s(e.$t("common.clear")),1)]),_:1})]),l(N,{"max-height":"250","wrap-class":"p-16 pt-0"},{default:a(()=>[(h(!0),y(H,null,U(d.value,(t,Y)=>(h(),y("div",{key:Y,class:"flex-between"},[c("div",$e,[l(E,{iconName:"app-workspace"}),c("span",{class:"ml-4 lighter ellipsis",title:t.name},s(t.name),9,ye)]),l($,{link:""},{default:a(()=>[l(B,{onClick:Ce=>J(t),size:18},{default:a(()=>[l(Q)]),_:1},8,["onClick"])]),_:2},1024)]))),128))]),_:1})])])),[[X,z.value]])]),_:1},8,["modelValue"])}}});export{Ae as _};
